var egret=window.egret,__reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},__awaiter=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(t){o(t)}}function a(e){try{l(n["throw"](e))}catch(t){o(t)}}function l(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}l((n=n.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,o&&(s=o[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(o,r[1])).done)return s;switch(o=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return l.label++,{value:r[1],done:!1};case 5:l.label++,o=r[1],r=[0];continue;case 7:r=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){l=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){l.label=r[1];break}if(6===r[0]&&l.label<s[1]){l.label=s[1],s=r;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(r);break}s[2]&&l.ops.pop(),l.trys.pop();continue}r=t.call(e,l)}catch(n){r=[6,n],o=0}finally{i=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var i,o,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:r(0),"throw":r(1),"return":r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},qufu;!function(e){var t=function(){function t(){this._stage=e.SceneManager.Instance._stage}return t.prototype.onResize=function(){},t.prototype.updateName=function(e){},t.prototype.updateInfo=function(e){},t.prototype.invitetips=function(e){},t.prototype.errtips=function(e){},t.prototype.hide=function(){this._stage.removeEventListener(egret.Event.RESIZE,this.onResize,this)},t.prototype.show=function(e){void 0===e&&(e=null),this._other=e,this._stage.addEventListener(egret.Event.RESIZE,this.onResize,this),this.onResize()},t}();e.SceneBase=t,__reflect(t.prototype,"qufu.SceneBase")}(qufu||(qufu={}));var qufu;!function(e){var t=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._view=null,e.loadArr=[],e.total=0,e.loaded=0,e.isAwait=!1,e}return __extends(r,t),r.prototype.show=function(){return __awaiter(this,void 0,void 0,function(){var e,r;return __generator(this,function(n){if(e=this,window.loadingView?e._view=window.loadingView:(e._view=new LoadingView,window.loadingView=e._view),e._view.showsize=0,e._stage.addChild(e._view),t.prototype.show.call(this),js_gameVars.resVersion||(js_gameVars.resVersion=""),!js_gameVars.publish)return e.loadingDebug(),[2];if(egret.nativeRender)return e.loadingNative(),[2];for(js_gameVars.iswx?e.loadingWXGame():js_gameVars.isuc?e.loadingUCGame():js_gameVars.isPreLoadZip?e.loadingZip():e.loadingNormal(),js_gameVars.enterGameStart=egret.getTimer(),e.total=e.loadArr.length,r=0;r<e.total;r++)e.loadNext(e.loadArr[r]);return[2]})})},r.prototype.loadingDebug=function(){return __awaiter(this,void 0,void 0,function(){var e,t,r;return __generator(this,function(n){switch(n.label){case 0:return e=this,[4,e.getJsonFile("manifest.json")];case 1:for(t=n.sent(),e.loadArr=t.game,e.total=e.loadArr.length,r=0;r<e.total;r++)e.loadNext(e.loadArr[r]);return[2]}})})},r.prototype.loadingNative=function(){var e=this;e.loadArr=["versionOk","js/main.min.js","resourceVersion.json"],e.total=e.loadArr.length,e.loadNextDebug()},r.prototype.loadingZip=function(){this.loadArr=[js_gameVars.resVersion+"/resourceVersion.zip",js_gameVars.resVersion+"/main.min.js"]},r.prototype.loadingWXGame=function(){this.loadArr=[js_gameVars.resVersion+"/resourceVersion.zip","main.min.js"]},r.prototype.loadingNormal=function(){this.loadArr=[js_gameVars.resVersion+"/resourceVersion.json",js_gameVars.resVersion+"/main.min.js"]},r.prototype.loadingUCGame=function(){this.loadArr=[js_gameVars.resVersion+"/resourceVersion.json","main.min.js"]},r.prototype.getJsonFile=function(e){return __awaiter(this,void 0,void 0,function(){var t,r=this;return __generator(this,function(n){return t=new Promise(function(t){RES.getResByUrl(e,function(e,r){t(e)},r,RES.ResourceItem.TYPE_JSON)}),[2,t]})})},r.prototype.loadNextDebug=function(){var e=this;e.isAwait=!0,e.loadNext(e.loadArr[e.loaded])},r.prototype.loadNext=function(e){var t=this;if("function"!=typeof platFromLoadNext||!platFromLoadNext(e,t.checkPatformFinish,this)){var r=e;if(r+=js_gameVars.noCache?"?v="+Math.random():js_gameVars.resver,"versionOk"==e)t.checkVersion();else if(-1!=e.indexOf("resourceVersion.json"))RES.getResByUrl(r,function(e,r){js_gameVars.resourceVersion=e,t.loaded++,t.checkFinish()},t,RES.ResourceItem.TYPE_JSON);else if(-1!=e.indexOf(".js")){var n=document.createElement("script");if(n.async=!1,egret.nativeRender)n.src=e+"?v="+Math.random();else if(void 0!=js_gameVars.cdnServer){var i=void 0==js_gameVars.cdnVersion?"?v=1.0.0":js_gameVars.cdnVersion;n.src=js_gameVars.cdnServer+e+i}else n.src=e+"?v="+Math.random();n.addEventListener("load",function(){n.parentNode.removeChild(n),n.removeEventListener("load",arguments.callee,!1),t.loaded++,t.checkFinish()},!1),document.body.appendChild(n)}else-1!=e.indexOf("resourceVersion.zip")&&(js_gameVars.resourceVersion?(t.loaded++,t.checkFinish()):RES.getResByUrl(r,function(e,r){JSZip.loadAsync(e).then(function(e){e.file("resourceVersion.json").async("text").then(function(e){js_gameVars.resourceVersion=JSON.parse(e),t.loaded++,t.checkFinish()})})},t,RES.ResourceItem.TYPE_BIN))}},r.prototype.checkPatformFinish=function(e){1==e&&(this.loaded++,this.checkFinish())},r.prototype.checkFinish=function(){var t=this;if(t.showProgress(),t.loaded>=t.total){console.log("complete");var r=egret.getDefinitionByName("Main"),n=new r;n.setConnection(e.connection),e.SceneManager.Instance.rootContainer.addChild(n),e.SceneManager.Instance.changeScene(null)}else t.isAwait&&t.loadNextDebug()},r.prototype.showProgress=function(){var e=this;e._view&&e._view.showPregress(e.loaded,e.total)},r.prototype.checkVersion=function(t){void 0===t&&(t=null);var r=this;if(e.EnterGameInstance.Instance.isVersionOk)r.loaded++,r.checkFinish();else if(null!=t){var n=t.split("_");r._view&&n.length>=3&&r._view.showPregress(parseInt(n[1]),parseInt(n[2]))}},r.prototype.onResize=function(){this._view&&this._view.onResize(this._stage.stageWidth,this._stage.stageHeight)},r.prototype.hide=function(){t.prototype.hide.call(this),this._view.parent&&this._view.parent==this._stage&&this._stage.removeChild(this._view)},r}(e.SceneBase);e.LoadingScene=t,__reflect(t.prototype,"qufu.LoadingScene")}(qufu||(qufu={}));var qufu;!function(e){var t=function(){function e(){this.qufu_name="",this.qufu_name1="",this.Recently_login=!1}return e}();e.NServerData=t,__reflect(t.prototype,"qufu.NServerData");var r=function(){function e(){this.name="",this.base=0,this.tag=0,this.hide="0"}return e}();e.GroupData=r,__reflect(r.prototype,"qufu.GroupData"),e.refer=new t,e.servers=[],e.isInWhiteList=!1,e.wxSocketConnect="wss://wx-login-bxcqh5.aimiplay.com",e.callBackWx=function(){js_gameVars.listObj?e.TalkToPhp.onGetData(js_gameVars.listObj):js_gameVars.platform_debug?HttpRequest.request(js_gameVars.APIlocation+"server/"+js_gameVars.platform_debug+"/list_"+js_gameVars.platform_debug+".txt?v="+(new Date).getTime(),e.TalkToPhp.onGetData,e.TalkToPhp):HttpRequest.request(js_gameVars.APIlocation+"server/"+js_gameVars.platform+"/list_"+js_gameVars.platform+".txt?v="+(new Date).getTime(),e.TalkToPhp.onGetData,e.TalkToPhp)}}(qufu||(qufu={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var qufu;!function(e){var t=function(t){function r(){var e=t.call(this)||this;return e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,RES.registerVersionController(new QufuVersionController),RES.setMaxLoadingThread(8),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(r,t),Object.defineProperty(r,"ver",{get:function(){return js_gameVars.qufuversion?js_gameVars.qufuversion:"1"},enumerable:!0,configurable:!0}),r.prototype.onAddToStage=function(t){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){return"function"==typeof createEgret&&createEgret(js_gameVars.username,js_gameVars.platform,js_gameVars.serverid),e.SceneManager.Instance._stage=this.stage,e.SceneManager.Instance.rootContainer=this,egret.Capabilities.isMobile||(this.stage.frameRate=60),js_gameVars.bgImg||(js_gameVars.bgImg="img/bg.png"),1==js_gameVars.isMobile&&(this.stage.scaleMode=egret.StageScaleMode.FIXED_WIDE),this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),1!=js_gameVars.isMobile&&(this.stage.orientation=egret.OrientationMode.AUTO,mouse.enable(this.stage)),egret.ImageLoader.crossOrigin="anonymous",t=new AssetAdapter,egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new QuFuThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("qufu_resource"+r.ver+"/default.res.json","qufu_resource"+r.ver+"/"),[2]})})},r.prototype.onConfigComplete=function(e){var t=this;RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,t.onConfigComplete,t);var n=null;js_gameVars.iswx?t.onThemeLoadComplete():(n=new eui.Theme("qufu_resource"+r.ver+"/qufu.json",t.stage),n.addEventListener(eui.UIEvent.COMPLETE,t.onThemeLoadComplete,t)),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,t),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,t.onResourceLoadError,t),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,t.onResourceProgress,t),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,t.onItemLoadError,t),RES.loadGroup("preload")},r.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},r.prototype.onResourceLoadComplete=function(e){var t=this;"preload"==e.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,t),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,t.onResourceLoadError,t),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,t.onResourceProgress,t),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,t.onItemLoadError,t),t.isResourceLoadEnd=!0,t.createScene())},r.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},r.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},r.prototype.onResourceProgress=function(e){"preload"==e.groupName},r.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},r.prototype.startCreateScene=function(){var t=document.getElementById("h5-loading-page-lay");if(t&&document.body.removeChild(t),4==js_gameVars.qufuType)return"function"==typeof pushServerInfo&&pushServerInfo(js_gameVars.username,js_gameVars.platform,js_gameVars.serverid),void e.SceneManager.Instance.changeScene(e.ConnectLoadingScene);if(void 0!=js_gameVars.serverid&&void 0!=js_gameVars.sNum&&void 0!=js_gameVars.serverHost&&void 0!=js_gameVars.serverPort&&3==js_gameVars.qufuType){var r=new e.NServerData;return js_gameVars.resver=e.resver="?v="+(new Date).getTime(),r.qufu_name=js_gameVars.serverHost,r.qufu_id=js_gameVars.serverid,r.show_state=2,r.gamePort=js_gameVars.serverPort,r.sNum=js_gameVars.sNum,r.cdn_version=js_gameVars.cdn_version,void e.EnterGameInstance.Instance.enterGame(r)}e.SceneManager.Instance.changeScene(e.SelectServerScene),e.callBackWx()},r}(egret.DisplayObjectContainer);e.QuFuMain=t,__reflect(t.prototype,"qufu.QuFuMain")}(qufu||(qufu={}));var QuFuThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,r,n){function i(e){t.call(n,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),r.call(n))}var s=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("qufu_resource"+qufu.QuFuMain.ver+"/gameEui.json",function(e,r){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(n,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var a=e.split("/");a.pop();var l=a.join("/")+"_EUI.json";generateJSON.paths[e]?egret.callLater(function(){t.call(n,generateJSON.paths[e])},this):RES.getResByUrl(l,function(r){window.JSONParseClass.setData(r),egret.callLater(function(){t.call(n,generateJSON.paths[e])},s)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(QuFuThemeAdapter.prototype,"QuFuThemeAdapter",["eui.IThemeAdapter"]);var qufu;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return(null==this._instance||void 0==this._instance)&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.changeScene=function(t,r){void 0===r&&(r=null);var n=this;t==e.LoadingScene&&n._curSence instanceof t||(n._curSence&&n._curSence.hide(),t&&(n._curSence=new t,n._curSence.show(r)))},t}();e.SceneManager=t,__reflect(t.prototype,"qufu.SceneManager")}(qufu||(qufu={}));var qufu;!function(e){var t=function(){function t(){}return t.onLatelyList=function(t){t||(t="[]");var r;try{r=JSON.parse(t)}catch(n){r=[]}if(e.SelectServerScene.isNewPlayer=!1,r.length<=0&&(e.SelectServerScene.isNewPlayer=!0,!js_gameVars.debug&&void 0!=e.refer.qufu_id&&3==js_gameVars.qufuType&&4!=e.refer.show_state&&!js_gameVars.noAutoEnter))return void e.EnterGameInstance.Instance.enterGame(e.refer);for(var i=[],o=0;o<r.length;o++){var s=new e.NServerData;s.qufu_name=r[o][0],s.qufu_id=r[o][1],s.show_state=r[o][2],s.gamePort=r[o][3],s.sNum=r[o][4],s.cdn_version=r[o][5],i[o]=s}e.lastLoginList=i,e.SceneManager.Instance.changeScene(e.SelectServerScene)},t.onGetData=function(t){var r=null;r="string"==typeof t?JSON.parse(t):t,e.domain=r.domain,e.minclient=r.minclient,e.numberAbc=r.number,e.pagenum=r.pagenum,e.serverGroup=r.serverGroup,e.resurl=r.resurl,js_gameVars.resver=e.resver=r.resver,e.whitelist=r.whitelist;var n=r.notice;e.notice=[];for(var i=0;i<n.length;i++){var o=n[i];o.platformid==js_gameVars.qudao&&e.notice.push(o)}e.notice.sort(function(e,t){return e.type==t.type?e.id-t.id:1==e.type?-1:1==t.type?1:0}),e.notice.length<=0&&e.notice.push({name:"游戏公告",title:"公告",desc:""}),-1!=e.whitelist.indexOf(js_gameVars.ip)&&(e.isInWhiteList=!0),e.refer.qufu_name=r.refer[0],e.refer.qufu_id=r.refer[1],e.refer.show_state=r.refer[2],e.refer.gamePort=r.refer[3],e.refer.sNum=r.refer[4],e.refer.cdn_version=r.refer[5];for(var i=0;i<r.servers.length;i++)e.servers[i]=new e.NServerData,e.servers[i].qufu_name=r.servers[i][0],e.servers[i].qufu_id=r.servers[i][1],e.servers[i].show_state=r.servers[i][2],e.servers[i].gamePort=r.servers[i][3],e.servers[i].sNum=r.servers[i][4],e.servers[i].cdn_version=r.servers[i][5];this.getLastServerList()},t.getLastServerList=function(){js_gameVars.platform_debug?HttpRequest.request(js_gameVars.APIlocation+"kingapi/query_loginname.php?platform="+js_gameVars.platform_debug+"&type=query&loginname="+js_gameVars.username+"&time="+egret.getTimer(),this.onLatelyList,this):HttpRequest.request(js_gameVars.APIlocation+"kingapi/query_loginname.php?platform="+js_gameVars.qudao+"&type=query&loginname="+js_gameVars.username+"&time="+egret.getTimer(),this.onLatelyList,this)},t}();e.TalkToPhp=t,__reflect(t.prototype,"qufu.TalkToPhp")}(qufu||(qufu={}));var qufu;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){var e=this;return null==e._instance&&(e._instance=new t),e._instance},enumerable:!0,configurable:!0}),t.prototype.initWorker=function(){var t=this;t.worker||(t.worker=new Worker("../worker.js"),e.webWorker=t.worker,e.webWorker.onmessage=function(t){e.connection instanceof e.WebConnection&&("onopen"==t.data.method?e.connection.onSocketOpen():"onclose"==t.data.method?e.connection.onDisConnect():"onmessage"==t.data.method?e.connection.onReceiveMessage(t.data.msg):"onerror"==t.data.method&&e.connection.onConnectError())})},t.prototype.closeWorker=function(){this.worker&&e.webWorker&&(e.webWorker.terminate(),this.worker=null,e.webWorker=null)},t._instance=null,t}();e.WebWorker=t,__reflect(t.prototype,"qufu.WebWorker")}(qufu||(qufu={}));var qufu;!function(e){var t=function(){function t(){}return t.prototype.setHandler=function(e){this._handler=e},t.prototype.connect=function(t,r,n){void 0===n&&(n=!0);var i=this;i._isOld=n,i.webSocket&&i.webSocket.connected||(i.webSocket&&i.disconnect1(),i._host=t,i._port=r,i.webSocket=new egret.WebSocket,i.webSocket.addEventListener(egret.Event.CONNECT,i.onSocketOpen,i),i.webSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,i.onConnectError,i),i.webSocket.addEventListener(egret.Event.CLOSE,i.onDisConnect,i),js_gameVars.monitormessage?i.webSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,i.onReceiveMessageAndMonitor,i):i.webSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,i.onReceiveMessage,i),i.webSocket.type=egret.WebSocket.TYPE_BINARY,void 0==js_gameVars.ssl||0==js_gameVars.ssl?i.webSocket.connect(t,r):n?i.webSocket.connectByUrl("wss://"+t+":"+r):i.webSocket.connectByUrl(""+e.wxSocketConnect+"?ip="+t+"&port="+r))},t.prototype.reconnect=function(){var t=this;void 0==js_gameVars.ssl||0==js_gameVars.ssl?t.webSocket.connect(t._host,t._port):t._isOld?t.webSocket.connectByUrl("wss://"+t._host+":"+t._port):t.webSocket.connectByUrl(""+e.wxSocketConnect+"?ip="+t._host+"&port="+t._port)},t.prototype.disconnect=function(){if(this.webSocket){if(!this.webSocket.connected)return;this.disconnect1()}},t.prototype.disconnect1=function(){var e=this;e.webSocket&&(e.webSocket.removeEventListener(egret.Event.CONNECT,e.onSocketOpen,e),e.webSocket.removeEventListener(egret.IOErrorEvent.IO_ERROR,e.onConnectError,e),e.webSocket.removeEventListener(egret.Event.CLOSE,e.onDisConnect,e),js_gameVars.monitormessage?e.webSocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,e.onReceiveMessageAndMonitor,e):e.webSocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,e.onReceiveMessage,e),e.webSocket.close(),e.webSocket=null)},t.prototype.connected=function(){return this.webSocket?this.webSocket.connected:!1},t.prototype.onConnectError=function(e){console.log("连接出错");var t=this;setTimeout(function(){t.reconnect()},1e3),"function"==typeof ConnectError?ConnectError(js_gameVars.username,js_gameVars.platform,js_gameVars.serverid):console.warn("platform="+js_gameVars.platform+"的ConnectError没有实现"),t._handler&&t._handler.connectError()},t.prototype.onDisConnect=function(e){console.log("断开连接"),this._handler&&this._handler.disConnect()},t.prototype.onSocketOpen=function(e){console.log("连接至服务器成功"),this._handler&&this._handler.connected()},t.prototype.onReceiveMessageAndMonitor=function(e){var t=this;for(t.byteArray||(t.byteArray=new egret.ByteArray),t.byteArray.clear(),t.webSocket.readBytes(t.byteArray);t.byteArray.bytesAvailable;){var r=t.byteArray.readInt()-4;if(!r||t.byteArray.bytesAvailable<r)break;var n=t.byteArray.position+r,i=t.byteArray.readInt();t.byteArray.readShort();t._handler.received(i,t.byteArray),t.byteArray.position=n}},t.prototype.onReceiveMessage=function(e){for(this.byteArray||(this.byteArray=new egret.ByteArray),this.byteArray.clear(),this.webSocket.readBytes(this.byteArray);this.byteArray.bytesAvailable;){var t=this.byteArray.readInt()-4;if(!t||this.byteArray.bytesAvailable<t)break;var r=this.byteArray.position+t,n=this.byteArray.readInt();this.byteArray.readShort();this._handler.received(n,this.byteArray),this.byteArray.position=r}},t.prototype.dispose=function(){this.disconnect()},t.prototype.sendData=function(e,t){void 0===t&&(t=null);var r=this.webSocket;if(r.connected){var n=10;null!=t&&(t.position=0,n+=t.length);var i=new egret.ByteArray;i.writeInt(n),i.writeInt(e),i.writeShort(1),null!=t&&i.writeBytes(t),r.writeBytes(i)}},t}();e.Connection=t,__reflect(t.prototype,"qufu.Connection",["IConnection"])}(qufu||(qufu={}));var qufu;!function(e){var t=function(){function t(){this._count=0,this._heartUintID=0,this._lastTime=0}return Object.defineProperty(t,"Instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},enumerable:!0,configurable:!0}),t.prototype.serverHeartBeat=function(){var t=egret.getTimer();this._count>=3&&(this._count=0,this._lastTime=t,e.connection.sendData(1009))},t.prototype.startHeartBeats=function(){0==this._heartUintID&&(this._heartUintID=setInterval(this.serverHeartBeat,1e3))},t.prototype.stopHeartBeats=function(){this._heartUintID>0&&(clearInterval(this._heartUintID),this._heartUintID=0)},t}();e.QufuHeartManager=t,__reflect(t.prototype,"qufu.QufuHeartManager")}(qufu||(qufu={}));var qufu;!function(e){var t=function(){function t(){}return t.sendReqTemporaryRoleMessage=function(r,n,i,o){var s=new Output;s.writeString(r),s.writeVarInt(n,!1),s.writeVarInt(i,!1),s.writeString(o),e.connection.sendData(t.CMDReqTemporaryRoleMessage,s.getBuffer())},t.sendReqCreateRoleMessage=function(r,n,i){var o=new Output;o.writeString(r),o.writeVarInt(n,!1),o.writeVarInt(i,!1),e.connection.sendData(t.CMDReqCreateRoleMessage,o.getBuffer())},t.sendReqEnterGameMessage=function(r){var n=new Output;n.writeLong(r),e.connection.sendData(t.CMDReqEnterGameMessage,n.getBuffer())},t.sendReqTryEnterGameMessage=function(r,n){var i=new Output;i.writeLong(r),e.connection.sendData(t.CMDReqTryEnterGameMessage,i.getBuffer())},t.sendReqRandomNameMessage=function(r,n){var i=new Output;i.writeVarInt(r,!1),e.connection.sendData(t.CMDReqRandomNameMessage,i.getBuffer())},t.prototype.pushCreateRole=function(e,t){switch(js_gameVars.platform){default:var r={uid:js_gameVars.username,roleId:e["uid"+t].toLongString(),roleName:e["roleName"+t],sex:1==e["sex"+t]?"男":"女",level:e["level"+t],career:["战士","战士","法师","道士"][e["career"+t]],platform:js_gameVars.platform,sid:js_gameVars.serverid,serverName:js_gameVars.serverName,qudao:js_gameVars.qudao,time:(new Date).getTime()};"function"==typeof apiCreateRole&&apiCreateRole(r),egret.nativeRender&&egret.ExternalInterface.call("1004",JSON.stringify(r))}},t.prototype.received=function(r,n){var i=new Input;switch(js_gameVars.mylog&&console.log("qufucmd"+r),r){case t.CMDResCreateRoleMessage:i.setBytes(n,!1);var o={randomRoleName:void 0,uid1:void 0,roleName1:void 0,level1:void 0,sex1:void 0,career1:void 0,uid2:void 0,roleName2:void 0,level2:void 0,sex2:void 0,career2:void 0,lastLoginUid:void 0};o.randomRoleName=i.readString(),o.uid1=i.readLong(),o.roleName1=i.readString(),o.level1=i.readVarInt(!1),o.sex1=i.readVarInt(!1),o.career1=i.readVarInt(!1),o.uid2=i.readLong(),o.roleName2=i.readString(),o.level2=i.readVarInt(!1),o.sex2=i.readVarInt(!1),o.career2=i.readVarInt(!1),o.lastLoginUid=i.readLong(),js_gameVars.createRoleMsg=o,js_gameVars.loginSuccess=!0,e.SceneManager.Instance.changeScene(e.CreateRoleScence);break;case t.CMDResCreateRoleSuccessMessage:if(i.setBytes(n,!1),js_gameVars.createRolequfu=!0,js_gameVars.createRoleMsg.roleName1){var o={randomRoleName:void 0,uid1:void 0,roleName1:void 0,level1:void 0,sex1:void 0,career1:void 0,uid2:void 0,roleName2:void 0,level2:void 0,sex2:void 0,career2:void 0,lastLoginUid:void 0};o.randomRoleName="",o.uid2=i.readLong(),o.roleName2=i.readString(),o.sex2=i.readVarInt(!1),o.level2=i.readVarInt(!1),o.career2=i.readVarInt(!1),o.uid1=js_gameVars.createRoleMsg.uid1,o.roleName1=js_gameVars.createRoleMsg.roleName1,o.sex1=js_gameVars.createRoleMsg.sex1,o.level1=js_gameVars.createRoleMsg.level1,o.career1=js_gameVars.createRoleMsg.career1,js_gameVars.createRoleMsg=o,t.sendReqTryEnterGameMessage(o.uid2),this.pushCreateRole(o,2)}else{var o={randomRoleName:void 0,uid1:void 0,roleName1:void 0,level1:void 0,sex1:void 0,career1:void 0,uid2:void 0,roleName2:void 0,level2:void 0,sex2:void 0,career2:void 0,lastLoginUid:void 0};o.randomRoleName="",o.uid1=i.readLong(),o.roleName1=i.readString(),o.sex1=i.readVarInt(!1),o.level1=i.readVarInt(!1),o.career1=i.readVarInt(!1),o.uid2=js_gameVars.createRoleMsg.uid2,o.roleName2=js_gameVars.createRoleMsg.roleName2,o.sex2=js_gameVars.createRoleMsg.sex2,o.level2=js_gameVars.createRoleMsg.level2,o.career2=js_gameVars.createRoleMsg.career2,js_gameVars.createRoleMsg=o,t.sendReqTryEnterGameMessage(o.uid1),this.pushCreateRole(o,1)}break;case t.CMDResRandomNameMessage:i.setBytes(n,!1);var s=i.readString();js_gameVars.createRoleMsg.randomRoleName=s,e.SceneManager.Instance._curSence.updateName(s);break;case t.CMDResEnterGameMessage:i.setBytes(n,!1),js_gameVars.loginSuccess=!0;break;case t.CMDResTryEnterGameMessage:e.EnterGameInstance.Instance.enterLoadingScene();break;case t.CMDResVersionErrorMessage:i.setBytes(n,!1);var a=i.readVarInt(!1);console.log(a+"版本错误返回");break;case t.CMDResInfoMessage:i.setBytes(n,!1);i.readString();break;case t.CMDResWarnMessage:i.setBytes(n,!1);i.readString();break;case t.CMDResErrorMessage:i.setBytes(n,!1);var l=i.readString();e.SceneManager.Instance._curSence.errtips(l);break;case t.CMDResAlertMessage:i.setBytes(n,!1);var c=i.readString();e.SceneManager.Instance.changeScene(e.QFMaliceIPBase,c);break;case t.CMDResUseActiveCodeErrorMessage:i.setBytes(n,!1);var u=i.readString();e.SceneManager.Instance._curSence.invitetips(u)}},t.prototype.connected=function(){console.log("连接111111"),e.EnterGameInstance.Instance.onConnectOk(),e.EnterGameInstance.Instance.checkVersion(),e.QufuHeartManager.Instance.startHeartBeats();var t=0;if(void 0!=js_gameVars.resVersion){var r=""+js_gameVars.resVersion,n=r.split(".");n.length>2&&(t=parseInt(n[1]))}js_gameVars.middleVersion&&(t=js_gameVars.middleVersion),void 0!=js_gameVars.username?(console.log("连接222222"),"function"==typeof pushConnected?pushConnected(js_gameVars.username,js_gameVars.platform,js_gameVars.serverid):console.warn("platform="+js_gameVars.platform+"的ConnectError没有实现"),this.sendReqTemporaryLoginMessage(js_gameVars.username,js_gameVars.debug&&js_gameVars.debug_server_id?js_gameVars.debug_server_id:js_gameVars.server_id,parseInt(js_gameVars.platform),parseInt(js_gameVars.client),1==parseInt(js_gameVars.is_adult)?"1":"",js_gameVars.ip,t,js_gameVars.channel?js_gameVars.channel+"":"",js_gameVars.qudao?js_gameVars.qudao+"":"0",parseInt(js_gameVars.is_adult),js_gameVars.token)):e.EnterGameInstance.Instance.enterLoadingScene(),this.label&&this.label.parent&&(this.label.parent.removeChild(this.label),this.label=null)},t.prototype.disConnect=function(){},t.prototype.connectError=function(){if(js_gameVars.iswx)console.log("连接失败");else if(alert("连接失败"),null==this.label&&(this.label=new eui.Label("连接失败，正在重连。。。。"),this.label.x=e.SceneManager.Instance._stage.width/2-this.label.width/2,this.label.y=e.SceneManager.Instance._stage.height/2,e.SceneManager.Instance._stage.addChild(this.label)),js_gameVars.netFail2Reload){if(window.top)try{window.top.location.reload()}catch(t){window.location.reload()}else window.location.reload();egret.nativeRender&&egret.ExternalInterface.call("ResExitGame",js_gameVars.username)}},t.prototype.sendReqTemporaryLoginMessage=function(r,n,i,o,s,a,l,c,u,d,g,p){void 0===p&&(p=!1);var h=new Output;h.writeString(r),h.writeVarInt(n,!1),h.writeVarInt(i,!1),h.writeVarInt(o,!1),h.writeString(s),h.writeString(a),h.writeVarInt(l,!1),h.writeString(c),h.writeString(u),h.writeVarInt(d,!1),h.writeString(g),e.connection.sendData(t.CMDReqLoginMessage,h.getBuffer())},t.CMDReqLoginMessage=1001,t.CMDResCreateRoleMessage=1002,t.CMDReqCreateRoleMessage=1003,t.CMDReqRandomNameMessage=1004,t.CMDResRandomNameMessage=1005,t.CMDReqEnterGameMessage=1008,t.CMDResCreateRoleSuccessMessage=1018,t.CMDResEnterGameMessage=1006,t.CMDResLoginMessage=1007,t.CMDResVersionErrorMessage=1011,t.CMDResUseActiveCodeErrorMessage=1026,t.CMDReqTryEnterGameMessage=1028,t.CMDResTryEnterGameMessage=1029,t.CMDReqTemporaryRoleMessage=1030,t.CMDResInfoMessage=7001,t.CMDResWarnMessage=7002,t.CMDResErrorMessage=7003,t.CMDResAlertMessage=7004,t}();e.QufuMessageHandler=t,__reflect(t.prototype,"qufu.QufuMessageHandler",["IReceiveHandler"])}(qufu||(qufu={}));var QufuVersionController=function(){function e(){}return e.prototype.init=function(){var e=new Promise(function(e){e()});return e},e.prototype.getVirtualUrl=function(e){if(egret.nativeRender)return e;if(-1!=e.indexOf("resourceVersion.json"))return js_gameVars.cdnServer?js_gameVars.cdnServer+e:e;if(void 0!=js_gameVars.cdnHttpsServer){var t=new RegExp(".js$");if(t.test(e))return js_gameVars.cdnHttpsServer+e+("?qufu_version="+js_gameVars.qufu_version)}return void 0==js_gameVars.cdnServer?js_gameVars.debug?e+"?version="+Math.random():e:js_gameVars.cdnServer+e+("?qufu_version="+js_gameVars.qufu_version)},e}();__reflect(QufuVersionController.prototype,"QufuVersionController",["RES.VersionController","RES.IVersionController"]);var qufu;!function(e){var t=function(){function t(){this.isConnection=!1}return t.prototype.setHandler=function(e){this._handler=e},Object.defineProperty(t.prototype,"handler",{get:function(){return this._handler},enumerable:!0,configurable:!0}),t.prototype.connect=function(e,t){void 0==js_gameVars.ssl||0==js_gameVars.ssl?this.createWebSocket("ws://"+e+":"+t):this.createWebSocket("wss://"+e+":"+t),(js_gameVars.isCmd||js_gameVars.debug)&&console.log("WebConnection >host"+e,"portt"+t)},t.prototype.connected=function(){return this.isConnection},t.prototype.onConnectError=function(){this.isConnection=!1,console.log("WebConnection-------------------------->连接出错"),this._handler&&this._handler.connectError()},t.prototype.createWebSocket=function(t){e.webWorker.postMessage({cmd:"start",msg:t})},t.prototype.onDisConnect=function(){this.isConnection=!1,console.log("WebConnection-------------------------->断开连接"),this._handler&&this._handler.disConnect()},t.prototype.disconnect=function(){this.connected()},t.prototype.onSocketOpen=function(){this.isConnection=!0,console.log("WebConnection-------------------------->连接至服务器成功"),this._handler&&this._handler.connected()},t.prototype.onReceiveMessage=function(e){void 0===e&&(e=null);var t=new egret.ByteArray,r=new DataView(e);for(t.dataView=r;t.bytesAvailable;){var n=(t.readInt()-4,t.readInt());t.readShort();this._handler&&this._handler.received(n,t),js_gameVars.isCmd&&console.log("WebConnection------收到cmd---------------->"+n)}},t.prototype.sendData=function(t,r){void 0===r&&(r=null);var n=10;null!=r&&(r.position=0,n+=r.length);var i=new egret.ByteArray;i.writeInt(n),i.writeInt(t),i.writeShort(1),null!=r&&i.writeBytes(r),e.webWorker.postMessage({cmd:"sendMsg",msg:i.buffer}),js_gameVars.isCmd&&console.log("WebConnection------发送cmd---------------->"+t)},t.prototype.dispose=function(){e.webWorker.postMessage({cmd:"stop"})},t}();e.WebConnection=t,__reflect(t.prototype,"qufu.WebConnection",["IConnection"])}(qufu||(qufu={}));var Input=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=!0),this.chars=new egret.ByteArray,null!=e&&(this.buffer=e,t&&(this.buffer.position=0))}return Object.defineProperty(e.prototype,"bytesAvailable",{get:function(){return this.buffer.bytesAvailable},enumerable:!0,configurable:!0}),e.prototype.setBytes=function(e,t){void 0===t&&(t=!0),this.buffer=e,t&&(this.buffer.position=0)},e.prototype.require=function(e){if(this.buffer.bytesAvailable>=e)return this.buffer.bytesAvailable;
throw new Error},e.prototype.read=function(){return this.buffer.bytesAvailable<1?-1:255&this.buffer.readUnsignedByte()},e.prototype.skip=function(e){this.buffer.position=this.buffer.position+e},e.prototype.readByte=function(){return this.require(1),this.buffer.readByte()},e.prototype.readByteUnsigned=function(){return this.require(1),this.buffer.readUnsignedByte()},e.prototype.readBytes=function(e){var t=new egret.ByteArray;return this._readBytes(t,0,e),t},e.prototype._readBytes=function(e,t,r){this.buffer.readBytes(e,t,r)},e.prototype.readInt=function(){return this.require(4),(255&this.buffer.readUnsignedByte())<<24|(255&this.buffer.readUnsignedByte())<<16|(255&this.buffer.readUnsignedByte())<<8|255&this.buffer.readUnsignedByte()},e.prototype.readVarInt=function(e){if(this.require(1)<5)return this.readInt_slow(e);var t=this.buffer.readUnsignedByte(),r=127&t;return 0!=(128&t)&&(t=this.buffer.readUnsignedByte(),r|=(127&t)<<7,0!=(128&t)&&(t=this.buffer.readUnsignedByte(),r|=(127&t)<<14,0!=(128&t)&&(t=this.buffer.readUnsignedByte(),r|=(127&t)<<21,0!=(128&t)&&(t=this.buffer.readUnsignedByte(),r|=(127&t)<<28)))),e?r:r>>>1^-(1&r)},e.prototype.readInt_slow=function(e){var t=this.buffer.readUnsignedByte(),r=127&t;return 0!=(128&t)&&(this.require(1),t=this.buffer.readUnsignedByte(),r|=(127&t)<<7,0!=(128&t)&&(this.require(1),t=this.buffer.readUnsignedByte(),r|=(127&t)<<14,0!=(128&t)&&(this.require(1),t=this.buffer.readUnsignedByte(),r|=(127&t)<<21,0!=(128&t)&&(this.require(1),t=this.buffer.readUnsignedByte(),r|=(127&t)<<28)))),e?r:r>>>1^-(1&r)},e.prototype.readString=function(){var e=this.require(1),t=this.buffer.readUnsignedByte();if(0==(128&t))return this.readAscii();var r=e>=5?this.readUtf8Length(t):this.readUtf8Length_slow(t);switch(r){case 0:return null;case 1:return""}r-=1,this.chars.clear(),this.readUtf8(r);var n=this.chars.position;return this.chars.position=0,this.chars.readUTFBytes(n)},e.prototype.readUtf8Length=function(e){var t=63&e;return 0!=(64&e)&&(e=this.buffer.readUnsignedByte(),t|=(127&e)<<6,0!=(128&e)&&(e=this.buffer.readUnsignedByte(),t|=(127&e)<<13,0!=(128&e)&&(e=this.buffer.readUnsignedByte(),t|=(127&e)<<20,0!=(128&e)&&(e=this.buffer.readUnsignedByte(),t|=(127&e)<<27)))),t},e.prototype.readUtf8Length_slow=function(e){var t=63&e;return 0!=(64&e)&&(this.require(1),e=this.buffer.readUnsignedByte(),t|=(127&e)<<6,0!=(128&e)&&(this.require(1),e=this.buffer.readUnsignedByte(),t|=(127&e)<<13,0!=(128&e)&&(this.require(1),e=this.buffer.readUnsignedByte(),t|=(127&e)<<20,0!=(128&e)&&(this.require(1),e=this.buffer.readUnsignedByte(),t|=(127&e)<<27)))),t},e.prototype.readUtf8=function(e){for(var t=0,r=0,n=Math.min(this.require(1),e);n>r;){if(t=this.buffer.readByte(),0>t){var i=this.buffer,o=this.buffer.position-1;i.position=o;break}r+=1,this.chars.writeByte(t)}e>r&&this.readUtf8_slow(e,r)},e.prototype.readUtf8_slow=function(e,t){var r=0;for(this.buffer.position;e>t;){switch(r=255&this.buffer.readByte(),r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:this.chars.writeByte(r);break;case 12:case 13:this.chars.writeByte(r),this.chars.writeByte(this.buffer.readByte());break;case 14:this.chars.writeByte(r),this.chars.writeByte(this.buffer.readByte()),this.chars.writeByte(this.buffer.readByte())}t+=1}},e.prototype.readAscii=function(){var e=0,t=this.buffer.position,r=this.buffer.position,n=r-1,i=this.buffer.length;do{if(r==i)return this.buffer.position=t-1,this.readAscii_slow();e=this.buffer.readUnsignedByte(),r+=1}while(0==(128&e));this.buffer.position=r-1;var o=127&this.buffer.readByte();this.buffer.position=r-1,this.buffer.writeByte(o),this.buffer.position=t-1;var s=this.getStringFromDB(this.buffer,n,r-n),a=this.buffer.position;return this.buffer.position=r-1,o=128|this.buffer.readByte(),this.buffer.position=r-1,this.buffer.writeByte(o),this.buffer.position=a,s},e.prototype.getStringFromDB=function(e,t,r){for(var n=[],i=t;t+r>i;i++)n.push(String.fromCharCode(e.readUnsignedByte()));return n.join("")},e.prototype.readAscii_slow=function(){throw new Error("数据流中有不支持的字符串解析")},e.prototype.readFloat=function(){return this.buffer.readFloat()},e.prototype.readFloat2=function(e,t){return this.readInt_slow(t)/e},e.prototype.readShort=function(){return this.buffer.readShort()},e.prototype.readShortUnsigned=function(){return this.buffer.readUnsignedShort()},e.prototype.readLong=function(){var e=this.buffer.readUnsignedByte()<<24;e|=this.buffer.readUnsignedByte()<<16,e|=this.buffer.readUnsignedByte()<<8,e|=this.buffer.readUnsignedByte();var t=this.buffer.readUnsignedByte()<<24;return t|=this.buffer.readUnsignedByte()<<16,t|=this.buffer.readUnsignedByte()<<8,t|=this.buffer.readUnsignedByte(),Long.create(e,t)},e.prototype.readBoolean=function(){return 1==this.buffer.readUnsignedByte()},e.prototype.readChar=function(){return this.buffer.readUnsignedShort()},e.prototype.readDouble=function(){return this.buffer.readDouble()},e.prototype.readVarInts=function(e,t){for(var r=new Array,n=0;e>n;)r[n]=this.readVarInt(t),n+=1;return r},e.prototype.readInts=function(e){for(var t=new Array,r=0;e>r;)t[r]=this.readInt(),r+=1;return t},e.prototype.readLongs=function(e){for(var t=new Array,r=0;e>r;)t[r]=this.readLong(),r+=1;return t},e.prototype.readFloats=function(e){for(var t=new Array,r=0;e>r;)t[r]=this.readFloat(),r+=1;return t},e.prototype.readShorts=function(e){for(var t=new Array,r=0;e>r;)t[r]=this.readShort(),r+=1;return t},e.prototype.readChars=function(e){for(var t=new Array,r=0;e>r;)t[r]=this.readChar(),r+=1;return t},e.prototype.readDoubles=function(e){for(var t=new Array,r=0;e>r;)t[r]=this.readDouble(),r+=1;return t},e}();__reflect(Input.prototype,"Input");var Long=function(){function e(e,t){this._low=t,this._high=e}return e.create=function(t,r){return new e(t,r)},e.createFromStr=function(t){var r=t.split("_"),n=parseInt(r[1]),i=parseInt(r[0]);return new e(n,i)},e.prototype.toString=function(){return void 0==this._string&&(this._string=this._low+"_"+this._high),this._string},e.prototype.setHigh=function(e){this._high=e},e.prototype.getHigh=function(){return this._high},e.prototype.setLow=function(e){this._low=e},e.prototype.getLow=function(){return this._low},e.prototype.equals=function(e){return null==e?this.isZero()?!0:!1:this._low==e.getLow()&&this._high==e.getHigh()},e.prototype.isZero=function(){return 0==this._high&&0==this._low},e.readLong=function(t){var r=t.readUnsignedByte()<<24;r|=t.readUnsignedByte()<<16,r|=t.readUnsignedByte()<<8,r|=t.readUnsignedByte();var n=t.readUnsignedByte()<<24;return n|=t.readUnsignedByte()<<16,n|=t.readUnsignedByte()<<8,n|=t.readUnsignedByte(),new e(r,n)},e.writeLong=function(t,r){null==t&&(t=e.Zero),r.writeByte(t.getHigh()>>>24),r.writeByte(t.getHigh()>>>16),r.writeByte(t.getHigh()>>>8),r.writeByte(t.getHigh()),r.writeByte(t.getLow()>>>24),r.writeByte(t.getLow()>>>16),r.writeByte(t.getLow()>>>8),r.writeByte(t.getLow())},e.prototype.toNumber=function(){var e=this._low>=0?this._low:4294967296+this._low,t=this._high>=0?this._high:4294967296+this._high,r=2147483648&t;return r>0?4294967296*-(4294967296-t)-e:4294967296*t+e},e.createLongFromNumber=function(t){var r=0,n=0;return t>0?(r=(t-(t>>>32))/4294967296,n=t>>>32):0>t&&(n=(t>>32)-4294967296,r=(t+n)/4294967296+4294967296),e.create(r,n)},e.prototype.toLongString=function(){var e=new Uint8Array(8),t=new DataView(e.buffer);t.setInt32(0,this._high),t.setUint32(4,this._low);for(var r=[],n=0;8>n;n++)r.push(e[n]);var i=this.binaryTransfer(r,256,10);return i.join("")},e.prototype.binaryTransfer=function(e,t,r){for(var n=e.length,i=0;n-1>i;i++)for(var o=0;n-1-i>o;o++){var s=e[o];s*=t;var a=s%r;s=(s-a)/r,e[o]=s,e[o+1]+=a}return e=e.reverse(),this.toRadixArrStd(e,r),e.reverse()},e.prototype.toRadixArrStd=function(e,t){for(var r=e.length,n=0,i=0;r>i;i++){var o=e[i]+n,s=o%t;n=(o-s)/t,e[i]=s}if(n){do{var a=n%t;n=(n-a)/t,e.push(a)}while(n>0)}else this.removeBackZero(e,1);return e},e.prototype.removeBackZero=function(e,t){void 0===t&&(t=1);for(var r=e.length;r>t&&0==e[r-1];)e.pop(),r--},e.Zero=new e(0,0),e}();__reflect(Long.prototype,"Long");var Output=function(){function e(){this.buffer=new egret.ByteArray}return e.prototype.clear=function(){this.buffer.clear()},e.prototype.getBuffer=function(){return this.buffer},e.prototype.write=function(e){this.buffer.writeByte(e)},e.prototype.writeBytes=function(e,t,r){this.buffer.writeBytes(e,t,r)},e.prototype.writeByte=function(e){this.buffer.writeByte(e)},e.prototype.writeInt=function(e){this.buffer.writeInt(e)},e.prototype.writeVarInt=function(e,t){return t||(e=e<<1^e>>31),e>>>7==0?(this.buffer.writeByte(255&e),1):e>>>14==0?(this.buffer.writeByte(255&(127&e|128)),this.buffer.writeByte(e>>>7&255),2):e>>>21==0?(this.buffer.writeByte(255&(127&e|128)),this.buffer.writeByte(255&(e>>>7|128)),this.buffer.writeByte(e>>>14&255),3):e>>>28==0?(this.buffer.writeByte(255&(127&e|128)),this.buffer.writeByte(255&(e>>>7|128)),this.buffer.writeByte(255&(e>>>14|128)),this.buffer.writeByte(e>>>21&255),4):(this.buffer.writeByte(255&(127&e|128)),this.buffer.writeByte(255&(e>>>7|128)),this.buffer.writeByte(255&(e>>>14|128)),this.buffer.writeByte(255&(e>>>21|128)),this.buffer.writeByte(e>>>28&255),5)},e.prototype.writeLong=function(e){null==e&&(e=Long.Zero),this.buffer.writeByte(e.getHigh()>>>24),this.buffer.writeByte(e.getHigh()>>>16),this.buffer.writeByte(e.getHigh()>>>8),this.buffer.writeByte(e.getHigh()),this.buffer.writeByte(e.getLow()>>>24),this.buffer.writeByte(e.getLow()>>>16),this.buffer.writeByte(e.getLow()>>>8),this.buffer.writeByte(e.getLow())},e.prototype.writeString=function(e){var t=0,r=0,n=0,i=0;if(null==e)return void this.writeByte(128);var o=e.length;if(0==o)return void this.writeByte(129);var s=!1;if(o>1&&64>o)for(s=!0,t=0;o>t;){if(r=e.charCodeAt(t),r>127){s=!1;break}t+=1}if(s){this.buffer.writeUTFBytes(e),this.buffer.position=this.buffer.position-1;var a=128|this.buffer.readByte();this.buffer.position=this.buffer.position-1,this.buffer.writeByte(a)}else{for(this.writeUtf8Length(o+1),n=0,i=this.buffer.position;o>n&&(r=e.charCodeAt(n),!(r>127));)this.buffer.writeByte(255&r),i+=1,n+=1;this.buffer.position=i,o>n&&this.writestring_slow(e,o,n)}},e.prototype.writeAscii=function(e){if(null==e)return void this.writeByte(128);var t=e.length;switch(t){case 0:return void this.writeByte(129);case 1:return this.writeByte(130),void this.writeByte(e.charCodeAt(0))}this.buffer.writeUTF(e),this.buffer.position=this.buffer.position-1;var r=128|this.buffer.readByte();this.buffer.position=this.buffer.position-1,this.buffer.writeByte(r)},e.prototype.writeUtf8Length=function(e){e>>>6==0?this.buffer.writeByte(255&(128|e)):e>>>13==0?(this.buffer.writeByte(255&(64|e|128)),this.buffer.writeByte(e>>>6&255)):e>>>20==0?(this.buffer.writeByte(255&(64|e|128)),this.buffer.writeByte(255&(e>>>6|128)),this.buffer.writeByte(e>>>13&255)):e>>>27==0?(this.buffer.writeByte(255&(64|e|128)),this.buffer.writeByte(255&(e>>>6|128)),this.buffer.writeByte(255&(e>>>13|128)),this.buffer.writeByte(e>>>20&255)):(this.buffer.writeByte(255&(64|e|128)),this.buffer.writeByte(255&(e>>>6|128)),this.buffer.writeByte(255&(e>>>13|128)),this.buffer.writeByte(255&(e>>>20|128)),this.buffer.writeByte(e>>>27&255))},e.prototype.writestring_slow=function(e,t,r){for(var n=0;t>r;)n=e.charCodeAt(r),127>=n?this.buffer.writeByte(255&n):n>2047?(this.buffer.writeByte(255&(224|n>>12&15)),this.buffer.writeByte(255&(128|n>>6&63)),this.buffer.writeByte(255&(128|63&n))):(this.buffer.writeByte(255&(192|n>>6&31)),this.buffer.writeByte(255&(128|63&n))),r+=1},e.prototype.writeFloat=function(e){this.buffer.writeFloat(e)},e.prototype.writeFloat2=function(e,t,r){this.writeVarInt(e*t,r)},e.prototype.writeShort=function(e){this.buffer.writeShort(e)},e.prototype.writeBoolean=function(e){this.buffer.writeBoolean(e)},e.prototype.writeChar=function(e){this.buffer.writeShort(e)},e.prototype.writeDouble=function(e){this.buffer.writeDouble(e)},e.prototype.writeVarInts=function(e,t){for(var r=0,n=e.length;n>r;)this.writeVarInt(e[r],t),r+=1},e.prototype.writeInts=function(e){for(var t=0,r=e.length;r>t;)this.buffer.writeInt(e[t]),t+=1},e.prototype.writeFloats=function(e){for(var t=0,r=e.length;r>t;)this.writeFloat(e[t]),t+=1},e.prototype.writeShorts=function(e){for(var t=0,r=e.length;r>t;)this.writeShort(e[t]),t+=1},e.prototype.writeChars=function(e){for(var t=0,r=e.length;r>t;)this.writeChar(e[t]),t+=1},e.prototype.writeDoubles=function(e){for(var t=0,r=e.length;r>t;)this.writeDouble(e[t]),t+=1},e}();__reflect(Output.prototype,"Output");var qufu;!function(e){var t=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._view=null,e}return __extends(r,t),r.prototype.show=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(r){return e=this,this._view=new LoadingView,this._stage.addChild(this._view),this._view.setText("正在连接服务器。。。。。"),window.loadingView=this._view,t.prototype.show.call(this),HttpRequest.request(js_gameVars.APIlocation+"gameservers/serverlist_"+js_gameVars.platform+"_"+js_gameVars.serverid+".txt?v="+(new Date).getTime(),this.onGetData,this,null,[js_gameVars.serverid]),[2]})})},r.prototype.onGetData=function(t,r){if(t){var n=JSON.parse(t);js_gameVars.resver=e.resver=n.resver;var i=new e.NServerData;i.qufu_name=n.refer[0],i.qufu_id=n.refer[1],i.show_state=n.refer[2],i.gamePort=n.refer[3],i.sNum=n.refer[4],i.cdn_version=n.refer[5],e.domain=n.domain,e.whitelist=n.whitelist,null==e.whitelist&&(e.whitelist=[]),-1!=e.whitelist.indexOf(js_gameVars.ip)&&(e.isInWhiteList=!0),"function"==typeof pushServerInfo&&pushServerInfo2(js_gameVars.username,js_gameVars.platform,js_gameVars.serverid),e.EnterGameInstance.Instance.enterGame(i)}},r.prototype.onResize=function(){this._view&&this._view.onResize(this._stage.stageWidth,this._stage.stageHeight)},r.prototype.hide=function(){t.prototype.hide.call(this),this._view.parent&&this._view.parent==this._stage&&this._stage.removeChild(this._view)},r}(e.SceneBase);e.ConnectLoadingScene=t,__reflect(t.prototype,"qufu.ConnectLoadingScene")}(qufu||(qufu={}));var qufu;!function(e){var t=function(t){function r(){var e=t.call(this)||this;return e._view=null,e}return __extends(r,t),r.prototype.updateInfo=function(e){this._view&&this._view.setinfo(e)},r.prototype.updateName=function(e){this._view&&this._view.updateName()},r.prototype.errtips=function(e){this._view&&this._view.errtips(e)},r.prototype.invitetips=function(e){this._view&&this._view.invitetips(e)},r.prototype.show=function(){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(n){return r=this,r._view=new e.CreateRoleUICtrl3,r._stage.addChild(r._view),t.prototype.show.call(this),"function"==typeof platFromLoadNext&&platFromLoadNext("main.min.js",null,null),[2]})})},r.prototype.onResize=function(){this._view.onResize(this._stage.stageWidth,this._stage.stageHeight)},r.prototype.hide=function(){t.prototype.hide.call(this),this._view.parent&&this._view.parent==this._stage&&(this._stage.removeChild(this._view),this._view.dispose())},r}(e.SceneBase);e.CreateRoleScence=t,__reflect(t.prototype,"qufu.CreateRoleScence")}(qufu||(qufu={}));var qufu;!function(e){var t=function(){function t(){this._timeID=0,this.title="s",this.isVersionOk=!1}return Object.defineProperty(t,"Instance",{get:function(){return(null==this._instance||void 0==this._instance)&&(this._instance=new t,egret.nativeRender&&egret.ExternalInterface.addCallback("ResGetUserName2",function(t){js_gameVars.username=t,t&&t.length>0&&e.TalkToPhp.getLastServerList()})),this._instance},enumerable:!0,configurable:!0}),t.prototype.enterGame=function(t){var r=this;if(js_gameVars.needXieYi&&0==e.SelectServerScene.xieyiState)return void alert("请先同意《注册协议》");r.mServerInfo=t;var n=js_gameVars.username;if(!n||n.length<=0||"ceshi"==n)return void(egret.nativeRender?egret.ExternalInterface.call("ReqGetUserName2",""):alert("没有账号"));if(4==t.show_state&&(!e.isInWhiteList||-1==e.whitelist.indexOf(js_gameVars.ip)))return void alert("服务器维护中");if(e.connection||(js_gameVars.isWebWorker?(e.WebWorker.Instance.initWorker(),e.connection=new e.WebConnection):e.connection=new e.Connection,this._handler=new e.QufuMessageHandler,e.connection.setHandler(this._handler)),js_gameVars.qufuTest)e.connection.connect(""+t.qufu_name,t.gamePort+8e3,!0);else{var i=void 0==js_gameVars.forwardWs||""==js_gameVars.forwardWs;e.connection.connect(this.title+t.sNum+"-"+e.domain,t.gamePort+8e3,i)}this._timeID=setTimeout(function(){"function"==typeof pushConnectedTimeOut&&pushConnectedTimeOut(js_gameVars.username,js_gameVars.platform,js_gameVars.serverid)},2e3)},t.prototype.onConnectOk=function(){var t=this;t._timeID>0&&clearTimeout(t._timeID),js_gameVars.qufuTest?js_gameVars.serverHost=""+t.mServerInfo.qufu_name:js_gameVars.serverHost=t.title+t.mServerInfo.sNum+"-"+e.domain,js_gameVars.server_id=t.mServerInfo.qufu_id,js_gameVars.serverid=t.mServerInfo.qufu_id,js_gameVars.serverName=t.mServerInfo.qufu_name,js_gameVars.serverPort=t.mServerInfo.gamePort+8e3,js_gameVars.resVersion=t.mServerInfo.cdn_version,js_gameVars.middleVersion&&(js_gameVars.resVersion=""),js_gameVars.platform_debug?HttpRequest.request(js_gameVars.APIlocation+"kingapi/query_loginname.php?platform="+js_gameVars.platform_debug+"&type=update&serverid="+t.mServerInfo.qufu_id+"&loginname="+js_gameVars.username,function(e){},t):HttpRequest.request(js_gameVars.APIlocation+"kingapi/query_loginname.php?platform="+js_gameVars.qudao+"&type=update&serverid="+t.mServerInfo.qufu_id+"&loginname="+js_gameVars.username,function(e){},t)},t.prototype.checkVersion=function(){var t=this;egret.nativeRender?(t.isVersionOk=!1,egret.ExternalInterface.addCallback("ResVersionFinish",function(r){var n=e.SceneManager.Instance._curSence;t.isVersionOk=!0,n&&n.checkVersion&&n.checkVersion()}),egret.ExternalInterface.addCallback("ResVersionUpdate",function(t){var r=e.SceneManager.Instance._curSence;r&&r.checkVersion&&r.checkVersion(t)}),egret.ExternalInterface.call("ReqGetVersion",t.mServerInfo.cdn_version)):t.isVersionOk=!0},t.prototype.enterLoadingScene=function(){e.SceneManager.Instance.changeScene(e.LoadingScene)},t}();e.EnterGameInstance=t,__reflect(t.prototype,"qufu.EnterGameInstance")}(qufu||(qufu={}));var qufu;!function(e){var t=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._view=null,e.total=0,e.loaded=0,e.loadArr=[],e}return __extends(r,t),r.prototype.show=function(){return __awaiter(this,void 0,void 0,function(){var e,r;return __generator(this,function(n){switch(n.label){case 0:return e=this,window.loadingView?e._view=window.loadingView:(e._view=new LoadingView,window.loadingView=e._view),e._view.showsize=0,e._stage.addChild(e._view),t.prototype.show.call(this),js_gameVars.resVersion||(js_gameVars.resVersion=""),js_gameVars.publish?[3,2]:[4,e.getJsonFile("manifest.json")];case 1:return r=n.sent(),e.loadArr=r.game,[3,3];case 2:egret.nativeRender?e.loadArr=["versionOk","js/main.min.js","resourceVersion.json"]:e.loadArr=[js_gameVars.resVersion+"/resourceVersion.json",js_gameVars.resVersion+"/main.min.js"],n.label=3;case 3:return e.total=e.loadArr.length,e.loaded=0,e.loadNext(),[2]}})})},r.prototype.getJsonFile=function(e){return __awaiter(this,void 0,void 0,function(){var t,r=this;return __generator(this,function(n){return t=new Promise(function(t){RES.getResByUrl(e,function(e,r){t(e)},r,RES.ResourceItem.TYPE_JSON)}),[2,t]})})},r.prototype.loadNext=function(){var t=this;if(t.loaded>=t.total){console.log("complete");var r=egret.getDefinitionByName("Main"),n=new r,i=0;if(void 0!=js_gameVars.resVersion){var o=""+js_gameVars.resVersion,s=o.split(".");s.length>2&&(i=parseInt(s[0]))}n.setConnection(e.connection),e.SceneManager.Instance.rootContainer.addChild(n),e.SceneManager.Instance.changeScene(null)}else{t._view.showPregress(t.loaded,t.total);var a=t.loadArr[t.loaded];if("versionOk"==a)t.checkVersion();else if(-1!=a.indexOf("resourceVersion.json"))a+=js_gameVars.noCache?"?v="+Math.random():js_gameVars.resver,RES.getResByUrl(a,function(e,r){js_gameVars.resourceVersion=e,t.loaded++,t.loadNext()},t,RES.ResourceItem.TYPE_JSON);else{var l=document.createElement("script");if(l.async=!1,egret.nativeRender)l.src=a+"?v="+Math.random();else if(void 0!=js_gameVars.cdnServer){var c=void 0==js_gameVars.cdnVersion?"?v=1.0.0":js_gameVars.cdnVersion;l.src=js_gameVars.cdnServer+a+c}else l.src=a+"?v="+Math.random();l.addEventListener("load",function(){l.parentNode.removeChild(l),l.removeEventListener("load",arguments.callee,!1),t.loaded++,t.loadNext()},!1),document.body.appendChild(l)}}},r.prototype.checkVersion=function(t){void 0===t&&(t=null);var r=this;if(e.EnterGameInstance.Instance.isVersionOk)r.loaded++,r.loadNext();else if(null!=t){var n=t.split("_");r._view&&n.length>=3&&r._view.showPregress(parseInt(n[1]),parseInt(n[2]))}},r.prototype.onResize=function(){this._view&&this._view.onResize(this._stage.stageWidth,this._stage.stageHeight)},r.prototype.hide=function(){t.prototype.hide.call(this),this._view.parent&&this._view.parent==this._stage&&this._stage.removeChild(this._view)},r}(e.SceneBase);e.OldLoadingScene=t,__reflect(t.prototype,"qufu.OldLoadingScene")}(qufu||(qufu={}));var qufu;!function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._view=null,t}return __extends(t,e),t.prototype.show=function(t){void 0===t&&(t=null),this._view=new QFMaliceIPDialog(t),this._stage.addChild(this._view),e.prototype.show.call(this)},t.prototype.onResize=function(){this._view&&this._view.onResize(this._stage.stageWidth,this._stage.stageHeight)},t.prototype.hide=function(){e.prototype.hide.call(this),this._view.parent&&this._view.parent==this._stage&&this._stage.removeChild(this._view)},t}(e.SceneBase);e.QFMaliceIPBase=t,__reflect(t.prototype,"qufu.QFMaliceIPBase")}(qufu||(qufu={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,r){function n(n){t.call(r,n,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?n(i):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var qufu;!function(e){var t=function(t){function r(){var r=t.call(this)||this;r.dics={};var n=r;return n.bgView=new e.BgView,n.selectView=new e.SelectView,n.noticeView=new e.NoticeView,n.fixGameView=new e.FixGameView,n.shilingTips=new e.ShiLingTips,n.alerView=new e.AlertView,n.alerView.AlertId="backAlert",n.xieyiView=new e.XieYiView,n.addEvt(n.bgView,n.onEvtView,"open selectview","open noticeview","open fixGameView","open shilingTips","open xieyi","open backAlert","change xieyi"),n.addEvt(n.xieyiView,n.onEvtView,"close xieyi"),n.addEvt(n.alerView,n.onEvtView,"close backAlert","onSure backAlert"),n.addEvt(n.selectView,n.onEvtView,"close selectview"),n.addEvt(n.noticeView,n.onEvtView,"close noticeview"),n.addEvt(n.fixGameView,n.onEvtView,"close fixGameView"),n.addEvt(n.shilingTips,n.onEvtView,"close shilingTips"),r}return __extends(r,t),r.prototype.onEvtView=function(e,t,n){var i=this;switch(e){case"open selectview":i.openSelectView(null);break;case"open noticeview":i.openNoticeView(null);break;case"open fixGameView":i.openFixGameView();break;case"open shilingTips":i.openShiLingTips();break;case"open xieyi":i.openXieYi();break;case"open backAlert":i.openBackAlert();break;case"change xieyi":r.xieyiState=n;break;case"close xieyi":i.closeXieYi();break;case"close backAlert":i.closeBackAlert();break;case"onSure backAlert":i.onSureBackAlert();break;case"close selectview":i.closeSelectView(null);break;case"close noticeview":i.closeNoticeView(null);break;case"close fixGameView":i.closeFixGameView();break;case"close shilingTips":i.closeShiLingTips()}},r.prototype.addEvt=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=this;if(null!=e){i.rmvEvt.apply(i,[e].concat(r));for(var o=0;o<r.length;o++){var s=r[o];e.addEventListener(s,i.handleEvt,i),i.dics[s]={cbk:t,view:e,key:s}}}},r.prototype.handleEvt=function(e){var t=this.dics[e.type];t&&t.cbk&&t.cbk.call(this,t.key,t.view,e.data)},r.prototype.rmvEvt=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this;if(null!=e)for(var i=0;i<t.length;i++){var o=t[i];this.dics[o];e.removeEventListener(t[i],n.handleEvt,n),n.dics[o]=null,delete n.dics[o]}},r.prototype.openSelectView=function(e){this._stage.addChild(this.selectView)},r.prototype.closeSelectView=function(e){this._stage.removeChild(this.selectView)},r.prototype.openNoticeView=function(e){this._stage.addChild(this.noticeView)},r.prototype.closeNoticeView=function(e){this._stage.removeChild(this.noticeView)},r.prototype.openFixGameView=function(){this._stage.addChild(this.fixGameView)},r.prototype.closeFixGameView=function(){this._stage.removeChild(this.fixGameView)},r.prototype.openShiLingTips=function(){this._stage.addChild(this.shilingTips)},r.prototype.openXieYi=function(){this._stage.addChild(this.xieyiView)},r.prototype.closeXieYi=function(){this._stage.removeChild(this.xieyiView)},r.prototype.openBackAlert=function(){this.alerView.showAlert("确定要返回大厅么？"),this._stage.addChild(this.alerView)},r.prototype.closeBackAlert=function(){this._stage.removeChild(this.alerView)},r.prototype.onSureBackAlert=function(){"function"==typeof platformCallBackDT&&platformCallBackDT()},r.prototype.closeShiLingTips=function(){this._stage.removeChild(this.shilingTips)},r.prototype.onResize=function(){var e=this;e.bgView.onResize(e._stage.stageWidth,e._stage.stageHeight),e.selectView.onResize(e._stage.stageWidth,e._stage.stageHeight),e.noticeView.onResize(e._stage.stageWidth,e._stage.stageHeight),e.fixGameView.onResize(e._stage.stageWidth,e._stage.stageHeight),e.shilingTips.onResize(e._stage.stageWidth,e._stage.stageHeight),e.alerView.onResize(e._stage.stageWidth,e._stage.stageHeight),e.xieyiView.onResize(e._stage.stageWidth,e._stage.stageHeight)},r.prototype.hide=function(){t.prototype.hide.call(this);var e=this;e.bgView.dispose(),e.selectView.dispose(),e.noticeView&&e.noticeView.dispose(),e.fixGameView&&e.fixGameView.dispose(),e.shilingTips&&e.shilingTips.dispose(),e.alerView&&e.alerView.dispose(),e.xieyiView&&e.xieyiView.dispose();for(var r in e.dics){var n=e.dics[r];n&&n.view&&e.rmvEvt(n.view,n.key)}},r.prototype.show=function(){var r=this;r._stage.addChild(r.bgView),e.notice&&e.notice.length>0&&(js_gameVars.noShowNoticeView||r._stage.addChild(r.noticeView)),t.prototype.show.call(this)},r.xieyiState=!1,r.isNewPlayer=!0,r}(e.SceneBase);e.SelectServerScene=t,__reflect(t.prototype,"qufu.SelectServerScene")}(qufu||(qufu={}));var HttpRequest=function(){function e(){}return e.request=function(e,t,r,n,i,o){void 0===o&&(o=egret.URLRequestMethod.GET);var s=new egret.URLLoader,a=new egret.URLRequest;a.url=e,a.method=o,n?a.data=new egret.URLVariables(n):a.data=null;var l=this,c=function(e){t.call(r,e.target.data,i?i:null),s.removeEventListener(egret.Event.COMPLETE,c,l),s.removeEventListener(egret.IOErrorEvent.IO_ERROR,u,l)},u=function(n){console.log(e+"请求错误!"),t.call(r,null,i?i:null),s.removeEventListener(egret.Event.COMPLETE,c,l),s.removeEventListener(egret.IOErrorEvent.IO_ERROR,u,l)};s.addEventListener(egret.Event.COMPLETE,c,l),s.addEventListener(egret.IOErrorEvent.IO_ERROR,u,l),s.load(a)},e}();__reflect(HttpRequest.prototype,"HttpRequest");var QFMaliceIPDialog=function(e){function t(t){var r=e.call(this)||this;return r.txt_str=t,r}return __extends(t,e),t.prototype.createChildren=function(){this.skinName="QFMaliceIPDialogSkin",this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.doReturn,this),this.initView()},t.prototype.doReturn=function(e){this.parent&&this.parent.removeChild(this)},t.prototype.onResize=function(e,t){this.x=Math.floor((e-this.width)/2),this.y=Math.floor((t-this.height)/2)},t.prototype.initView=function(){var e=this;e.txt_decs.text=e.txt_str},t.prototype.dispose=function(){this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(QFMaliceIPDialog.prototype,"QFMaliceIPDialog");var LoadingView=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.createOk=!1,t._wordsUpdateTime=0,t._disposed=!1,t._words=["战士是三职业中HP最厚的职业，抗首领无压力！","法师是三职业中杀怪效率最快的，群攻魔法刷刷刷！","道士的诅咒毒术可抑制首领回血，挑战首领必备！","首领正在复活...请耐心等待！","个人首领会掉高级装备，记得每日都要挑战完成！","正在打磨武器，练级打怪事半功倍！","正在确认首领存活数量，请耐心等待！","提升转生等级可以解锁更高级的装备哦！","首领复活了，赶紧召集帮会小伙伴前去挑战！","正在前往玛法大陆..."],t.showsize=0,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.skinName="LoadingViewSkin",this.createOk=!0,1==js_gameVars.isMobile?js_gameVars.bgloadingM?this.bgImg.source=js_gameVars.bgloadingM:this.bgImg.source="img/bg_loading_m.jpg":js_gameVars.bgloading?this.bgImg.source=js_gameVars.bgloading:this.bgImg.source="img/bg_loading.jpg",this.txt_show.textAlign=egret.HorizontalAlign.CENTER,this.progress_bg.mask=this.rect_1,"string"==typeof js_copyright&&(this.txtcopyright.text=js_copyright,this.txtcopyright.visible=!0),"function"==typeof apiEnterLoadingView&&apiEnterLoadingView(js_gameVars.username,js_gameVars.roleid,egret.getTimer(),js_gameVars.platform,js_gameVars.serverid),this.setPos()},t.prototype.loadedJsonHandler=function(e,t){this._movieData=e,this.movieCreate()},t.prototype.loadedPngHandler=function(e,t){this._movieImage=e,this.movieCreate()},t.prototype.movieCreate=function(){return this._movieData&&this._movieImage&&this._disposed?(RES.destroyRes("img/loadXingMc.json"),void RES.destroyRes("img/loadXingMc.png")):void 0},t.prototype.showPregress=function(e,t){if(this.createOk){this.showsize=e/t*927,this.rect_1.x=-10+this.showsize-927,this.setMoviePos(),this.setPos();var r=egret.getTimer();if(this._wordsUpdateTime<r){var n=this._words[Math.floor(Math.random()*this._words.length)];this.txt_show.text=n,this._wordsUpdateTime=r+1e3}}},t.prototype.setMoviePos=function(){this._movieClip&&(this._movieClip.x=42+this.showsize-67,this._movieClip.x>745&&(this._movieClip.x=745),this._movieClip.y=this.progress_bg.y-30)},t.prototype.setPos=function(){1==js_gameVars.isMobile?(this.group_jindu.bottom="60",this.txtLoadingWords.top="14",this.txtLoadingWords.text="抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。适度游戏益脑，沉迷游戏伤身。合理安排时间，享受健康生活。",this.bgImg.verticalCenter="0"):(this.group_jindu.bottom="165",this.txtLoadingWords.bottom="66",this.txtLoadingWords.text="抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。\n适度游戏益脑，沉迷游戏伤身。合理安排时间，享受健康生活。",this.bgImg.verticalCenter="0"),this.txtLoadingWords.horizontalCenter="0"},t.prototype.setText=function(e){this.createOk&&(this.showsize=733,this.rect_1.x=42+this.showsize-780,this.setMoviePos(),this.setPos(),this.txt_show.text=e)},t.prototype.onResize=function(e,t){this.width=e,this.height=t,this.setMoviePos(),this.setPos()},t.prototype.dispose=function(){RES.destroyRes(this.bgImg.source),this._movieClip&&(this._movieClip.parent&&this._movieClip.parent.removeChild(this._movieClip),this._movieClip=null,RES.destroyRes("img/loadXingMc.json"),RES.destroyRes("img/loadXingMc.png")),this.txt_show.text="",this._disposed=!0},t}(eui.Component);__reflect(LoadingView.prototype,"LoadingView");var qufu;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){var e=this;e.skinName="AlertSkin",e.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onSure,e),e.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onClose,e),e.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onClose,e),e.lbl_content.text=e.msg},t.prototype.showAlert=function(e){var t=this;t.lbl_content?t.lbl_content.text=t.msg=e:t.msg=e},t.prototype.onSure=function(e){this.dispatchEvent(new egret.Event("onSure "+this.AlertId))},t.prototype.onClose=function(e){this.dispatchEvent(new egret.Event("close "+this.AlertId))},t.prototype.dispose=function(){var e=this;e.parent&&e.parent.removeChild(e),e.btn_sure&&e.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onSure,e),e.btn_cancel&&e.btn_cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClose,e),e.btn_close&&e.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClose,e)
},t.prototype.onResize=function(e,t){var r=this;r.x=(e-450)/2,r.y=(t-300)/2},t}(eui.Component);e.AlertView=t,__reflect(t.prototype,"qufu.AlertView")}(qufu||(qufu={}));var qufu;!function(e){var t=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._disposed=!1,e}return __extends(r,t),r.prototype.createChildren=function(){var t=this;t.skinName="BgViewSkin",t.bgImg.source=js_gameVars.bgImg;var r=(new egret.HtmlTextParser,js_gameVars.defaultServerShow?js_gameVars.defaultServerShow:"");if(1==js_gameVars.qufuType?e.lastLoginList&&e.lastLoginList.length>0?(t.setBItState(e.lastLoginList[0].show_state),t.txt_server1.label=e.lastLoginList[0].qufu_id+"区"):void 0!=e.refer.qufu_id?(t.setBItState(e.refer.show_state),t.txt_server1.label=e.refer.qufu_id+"区"):t.txt_server1.label="":2==js_gameVars.qufuType?e.lastLoginList&&e.lastLoginList.length>0?(t.setBItState(e.lastLoginList[0].show_state),t.txt_server1.label=e.lastLoginList[0].qufu_name+"-"+e.lastLoginList[0].qufu_id):void 0!=e.refer.qufu_id?(t.setBItState(e.refer.show_state),t.txt_server1.label=e.refer.qufu_name+"-"+e.refer.qufu_id):t.txt_server1.label=r:e.lastLoginList&&e.lastLoginList.length>0?(t.setBItState(e.lastLoginList[0].show_state),t.txt_server1.label=""+e.lastLoginList[0].qufu_name):void 0!=e.refer.qufu_id?(t.setBItState(e.refer.show_state),t.txt_server1.label=""+e.refer.qufu_name):t.txt_server1.label=r,t.txt_server1.label!=r?t.bit_state1.visible=!0:t.bit_state1.visible=t.bit_state2.visible=!1,t.img_server2.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onChnageQu,t),t.txt_server1.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onChnageQu,t),t.btn_notice.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onOpenNoticeView,t),t.btn_notice.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onBtnBegin,t),t.btn_notice.addEventListener(egret.TouchEvent.TOUCH_END,t.onBtnEnd,t),t.btn_notice.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.onBtnEnd,t),t.btn_fix.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onOpenFixAlert,t),t.btn_fix.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onBtnBegin,t),t.btn_fix.addEventListener(egret.TouchEvent.TOUCH_END,t.onBtnEnd,t),t.btn_fix.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,t.onBtnEnd,t),t.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onStart,t),t.img_slts.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onOpenShiLingTips,t),t.chk_xy.addEventListener(eui.UIEvent.CHANGE,t.onChangeXieYi,t),9==js_gameVars.platform&&(t.img_slts.visible=!0),js_gameVars.js_copyright?t.txtcopyright.text=js_gameVars.js_copyright:"string"==typeof js_copyright&&(t.txtcopyright.text=js_copyright),"string"==typeof js_gametips&&(t.txtLoadingWords.text=js_gametips),t.btn_fix.visible=!!egret.nativeRender&&!!js_gameVars.isNative,js_gameVars.needXieYi){t.grp_xy.visible=!0;var n=new egret.HtmlTextParser;t.lbl_xy.textFlow=n.parse("我已阅读并同意<font color='#28ef01'>《注册协议》</font>和<font color='#28ef01'>《隐私政策协议》</font>"),t.lbl_xy.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTAPXY,t),1==js_gameVars.needXieYi?t.changeXieYi(!1):2==js_gameVars.needXieYi&&e.SelectServerScene.isNewPlayer?t.changeXieYi(!1):t.changeXieYi(!0)}else t.grp_xy.visible=!1;js_gameVars.needBackDT?(t.btn_fix.visible?t.btn_back.y=218:t.btn_back.y=160,t.btn_back.visible=!0,t.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onTAPBack,t)):t.btn_back.visible=!1},r.prototype.changeXieYi=function(e){this.chk_xy.selected=e,this.onChangeXieYi()},r.prototype.onChangeXieYi=function(){this.dispatchEvent(new egret.Event("change xieyi",!1,!1,this.chk_xy.selected))},r.prototype.onTAPXY=function(e){this.dispatchEvent(new egret.Event("open xieyi"))},r.prototype.onTAPBack=function(e){this.dispatchEvent(new egret.Event("open backAlert"))},r.prototype.onBtnBegin=function(e){e.currentTarget},r.prototype.onBtnEnd=function(e){e.currentTarget},r.prototype.loadedJsonHandler=function(e,t){this._movieData=e,this.movieCreate()},r.prototype.loadedPngHandler=function(e,t){this._movieImage=e,this.movieCreate()},r.prototype.movieCreate=function(){this._movieData&&this._movieImage&&this._disposed},r.prototype.setBItState=function(e){1==e?(this.bit_state1.source="",this.bit_state2.source="qufu_state2_png"):2==e?(this.bit_state1.source="qufu_state2_png",this.bit_state2.source=""):3==e?(this.bit_state1.source="qufu_state3_png",this.bit_state2.source="qufu_hot_png"):4==e?(this.bit_state1.source="qufu_state4_png",this.bit_state2.source=""):5==e&&(this.bit_state1.source="",this.bit_state2.source="")},r.prototype.onLink=function(t){"lastLoginList"==t.text?this.dispatchEvent(new egret.Event("open selectview")):"refer"==t.text&&e.EnterGameInstance.Instance.enterGame(e.refer)},r.prototype.onChnageQu=function(e){this.dispatchEvent(new egret.Event("open selectview"))},r.prototype.onStart=function(t){e.lastLoginList&&e.lastLoginList.length>0?e.EnterGameInstance.Instance.enterGame(e.lastLoginList[0]):e.refer?(e.EnterGameInstance.Instance.enterGame(e.refer),this._movieClip&&this._movieClip.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onStart,this)):this.dispatchEvent(new egret.Event("open selectview"))},r.prototype.onOpenNoticeView=function(e){this.dispatchEvent(new egret.Event("open noticeview"))},r.prototype.onOpenFixAlert=function(e){this.dispatchEvent(new egret.Event("open fixGameView"))},r.prototype.onUpdate=function(e){window.open("http://192.168.5.126:83/php/tool.html")},r.prototype.onOpenShiLingTips=function(){this.dispatchEvent(new egret.Event("open shilingTips"))},r.prototype.onResize=function(e,t){this.width=e,this.height=t,this.group_1.horizontalCenter="0",this.btn_start.horizontalCenter="0",this.txtLoadingWords.horizontalCenter="0"},r.prototype.dispose=function(){var e=this;e.parent&&e.parent.removeChild(e),e._disposed=!0,e.img_server2.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onChnageQu,e),e.txt_server1.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onChnageQu,e),e.btn_notice.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onBtnBegin,e),e.btn_notice.removeEventListener(egret.TouchEvent.TOUCH_END,e.onBtnEnd,e),e.btn_notice.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,e.onBtnEnd,e),e.btn_notice.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onOpenNoticeView,e),e.btn_fix.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onBtnBegin,e),e.btn_fix.removeEventListener(egret.TouchEvent.TOUCH_END,e.onBtnEnd,e),e.btn_fix.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,e.onBtnEnd,e),e.btn_fix.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onOpenFixAlert,e),e.btn_start.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onStart,e),e.img_slts.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onOpenShiLingTips,e),e.lbl_xy.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onTAPXY,e),e.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onTAPBack,e),e.chk_xy.removeEventListener(eui.UIEvent.CHANGE,e.onChangeXieYi,e),e._movieClip&&(e._movieClip.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onStart,e),e._movieClip.parent&&e._movieClip.parent.removeChild(e._movieClip),e._movieClip=null,RES.destroyRes("img/startGameMc6.json"),RES.destroyRes("img/startGameMc6.png"))},r}(eui.Component);e.BgView=t,__reflect(t.prototype,"qufu.BgView")}(qufu||(qufu={}));var CreateRoleUICtrl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._disposed=!1,t}return __extends(t,e),t.prototype.toEle=function(e){if(void 0==e)return[];var t=/<br>/gi,r="\n",n=e.replace(t,r),i=new egret.HtmlTextParser,o=i.parser(n);return o},t.prototype.createChildren=function(){var e=this;this.skinName="CreateRoleSkin3",e.text_err1.visible=e.txdescGro.visible=!1,155==js_gameVars.channel?(e.txGroup.visible=!0,"string"==typeof js_txYingDesc&&(this.txDesc.text=js_txYingDesc),e.tx_link1.textFlow=e.toEle("<u>应用用户协议</u>"),e.tx_link2.textFlow=e.toEle("<u>更多</u>"),e.tx_link3.textFlow=e.toEle("<u>实名认证>></u>"),e.tx_link1.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onClick,e),e.tx_link3.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onClick,e),e.tx_linkGro.addEventListener(mouse.MouseEvent.ROLL_OVER,e.showTxTips,e),e.tx_linkGro.addEventListener(mouse.MouseEvent.ROLL_OUT,e.closeTxTips,e),e.txCkeck.selected=!0):(e.txGroup.visible=!1,e.txCkeck.selected=!1),e.occupationSex=new eui.RadioButtonGroup,e.r_sex1.group=e.occupationSex,e.r_sex2.group=e.occupationSex,e.r_sex1.value=1,e.r_sex2.value=2,e.r_sex1.selected=!0,e.occupationZy=new eui.RadioButtonGroup,e.r_zy1.group=e.occupationZy,e.r_zy2.group=e.occupationZy,e.r_zy3.group=e.occupationZy,e.r_zy1.value=1,e.r_zy2.value=2,e.r_zy3.value=3,e.r_xz.x=e.r_zy1.x-2,e.r_xz.y=e.r_zy1.y,e.r_zy1.selected=!0,e.roleNameTxt.text=js_gameVars.createRoleMsg.randomRoleName,e.text_err.visible=!1,e.invite=0,e.invite=js_gameVars.createRoleMsg.needActiveCode,0==e.invite?e.grp_jhm.visible=!1:e.grp_jhm.visible=!0,e.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onBackSelectView,e),e.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onStartGame,e),e.occupationSex.addEventListener(eui.UIEvent.CHANGE,e.radioChangeHandler,e),e.occupationZy.addEventListener(eui.UIEvent.CHANGE,e.zyradioChangeHandler,e),e.btn_random.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onRandomNameClick,e),e.initDaoJiShi(),e.setTimeLimit(),e.img_nan.source="qufu_resource1/assets/gameui2/jpg/createRole3/ncrer_zy11.png",RES.getResByUrl("img/startGameMc4.json",this.loadedJsonHandler,this,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/startGameMc4.png",this.loadedPngHandler,this,RES.ResourceItem.TYPE_IMAGE),"function"==typeof apiEnterCreateRoleView&&apiEnterCreateRoleView(js_gameVars.username,js_gameVars.roleid,egret.getTimer(),js_gameVars.platform,js_gameVars.serverid),e.loadtimeID=setTimeout(function(){e.startLoad()},9500)},t.prototype.initDaoJiShi=function(){this.time=20,js_gameVars.defaultDaoJiShi&&(this.time=js_gameVars.defaultDaoJiShi)},t.prototype.onClick=function(e){var t=this;e.currentTarget==t.tx_link1?"function"==typeof txOpenShouQuanUrl&&txOpenShouQuanUrl(1):e.currentTarget==t.tx_link3&&"function"==typeof txOpenShouQuanUrl&&txOpenShouQuanUrl(2)},t.prototype.showTxTips=function(e){this.txdescGro.visible=!0},t.prototype.closeTxTips=function(e){this.txdescGro.visible=!1},t.prototype.updateName=function(e){this.roleNameTxt.text=e},t.prototype.invitetips=function(e){this.txt_invite.text=e,this.img_txtbg.width=this.txt_invite.width+20},t.prototype.errtips=function(e){this.text_err.visible=!0,this.text_err.text=e},t.prototype.loadedJsonHandler=function(e,t){this._movieData=e,this.movieCreate()},t.prototype.loadedPngHandler=function(e,t){this._movieImage=e,this.movieCreate()},t.prototype.movieCreate=function(){var e=this;if(this._movieData&&this._movieImage){if(this._disposed)return;var t=new egret.MovieClipDataFactory(this._movieData,this._movieImage);t.enableCache=!1,e._movieClip=new egret.MovieClip(t.generateMovieClipData("startGameMc4")),e.grp_eff.addChild(this._movieClip),1==parseInt(js_gameVars.isMobile)?(e._movieClip.x=-45,e._movieClip.y=-26,e._movieClip.scaleY=e._movieClip.scaleX=.9):(e._movieClip.x=-50,e._movieClip.y=-48),e._movieClip.blendMode=egret.BlendMode.ADD,e._movieClip.touchEnabled=!1,e._movieClip.play(-1)}},t.prototype.setTimeLimit=function(){var e=this;e.timeOut&&clearInterval(e.timeOut),e.txt_limitTime.textFlow=e.textFlowStr(),e.time--,e.timeOut=setInterval(function(){e.txt_limitTime.textFlow=e.textFlowStr(),e.time--,e.time<0&&(clearInterval(e.timeOut),e.onStartGame())},1e3)},t.prototype.textFlowStr=function(){var e="<font color=0xf4550a>"+this.time+"s</font><font color=0xfcf4e7>后进入游戏！</font>",t=new egret.HtmlTextParser,r=t.parser(e);return r},t.prototype.radioChangeHandler=function(e){var t=this,r=e.target;r==t.occupationSex,t.img_nan.source="qufu_resource1/assets/gameui2/jpg/createRole3/ncrer_zy11.png",t.initDaoJiShi(),t.setTimeLimit()},t.prototype.zyradioChangeHandler=function(e){var t=this,r=e.target,n=t["r_zy"+r.selectedValue];t.img_nan.source="qufu_resource1/assets/gameui2/jpg/createRole3/ncrer_zy"+t.occupationZy.selectedValue+t.occupationSex.selectedValue+".png",t.r_xz.x=n.x-2,t.r_xz.y=n.y,t.initDaoJiShi(),t.setTimeLimit()},t.prototype.onRandomNameClick=function(e){var t=this;qufu.QufuMessageHandler.sendReqRandomNameMessage(t.occupationSex.selectedValue),t.initDaoJiShi(),t.setTimeLimit()},t.prototype.onBackSelectView=function(e){egret.nativeRender&&egret.ExternalInterface.call("ResExitGame",js_gameVars.username),qufu.SceneManager.Instance.changeScene(qufu.SelectServerScene)},t.prototype.onStartGame=function(){var e=this;if(1==e.txGroup.visible){if(0==e.txCkeck.selected)return void(e.text_err1.visible=!0);e.text_err1.visible=!1}var t=e.roleNameTxt.text;if(!(t.indexOf("#")>=0))return"function"==typeof apiCreateRoleBtnClick&&apiCreateRoleBtnClick(js_gameVars.username,0,egret.getTimer(),js_gameVars.platform,t,e.occupationSex.selectedValue,e.occupationZy.selectedValue,js_gameVars.serverid),js_gameVars.createRoleName=t,qufu.QufuMessageHandler.sendReqTemporaryRoleMessage(t,e.occupationSex.selectedValue,e.occupationZy.selectedValue,e.txt_jhm.text),!0},t.prototype.startLoad=function(){var e=this;e.loader=new egret.URLLoader,e.loader.dataFormat=egret.URLLoaderDataFormat.SOUND,e.loader.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this);var t,r="audio/",n=".wav",i=".mp3",o=js_gameVars.resUrl?js_gameVars.resUrl:"http://192.168.5.66:8081/";t=js_gameVars.mobileUI||1==js_gameVars.client?o+r+10301+i:o+r+10301+n,void 0==js_gameVars.cdnServer||(t=js_gameVars.cdnServer+t+("?qufu_version="+js_gameVars.qufu_version));var s=new egret.URLRequest(t);e.loader.load(s)},t.prototype.onLoadComplete=function(e){var t=this,r=e.target;r.data&&(t.sound=r.data,t.startSound()),t.loader.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this)},t.prototype.startSound=function(){this.soundChannel=this.sound.play(0,-1)},t.prototype.stopSound=function(){var e=this;e.soundChannel&&(e.soundChannel.stop(),e.soundChannel=null),e.sound&&(e.sound.close(),e.sound=null),e.loader&&(e.loader.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),e.loader=null)},t.prototype.onResize=function(e,t){var r=this;r.x=e-r.skin.width>>1,r.y=t-r.skin.height>>1,1==parseInt(js_gameVars.isMobile)?(r.img_bg.source="qufu_resource1/assets/gameui2/jpg/createRole3/ncrer_bgi1.jpg",r.img_nan.scaleX=.6,r.img_nan.scaleY=.6,r.img_nan.horizontalCenter=-300,r.grp_btns.verticalCenter=15,r.grp_btns.horizontalCenter=380,r.grp_jhm.verticalCenter=210,r.grp_jhm.horizontalCenter=-100,r.btn_start.scaleX=.9,r.btn_start.scaleY=.9,r.grp_name.x=0,r.grp_name.y=380):(r.img_bg.source="qufu_resource1/assets/gameui2/jpg/createRole3/ncrer_bgi0.jpg",window.innerHeight<840||window.innerWidth<1396?(r.grp_btns.verticalCenter=15,r.grp_btns.horizontalCenter=280,r.grp_jhm.verticalCenter=210,r.grp_jhm.horizontalCenter=-220):(r.grp_btns.verticalCenter=157,r.grp_btns.horizontalCenter=512,r.grp_jhm.verticalCenter=350,r.grp_jhm.horizontalCenter=0)),r.grp_eff.y=0,r.txGroup.visible&&(r.txGroup.verticalCenter=272,r.txGroup.horizontalCenter=512,r.grp_eff.y=-40)},t.prototype.dispose=function(){this.stopSound(),this.parent&&this.parent.removeChild(this);var e=this;e._disposed=!0,this._movieClip&&(this._movieClip.parent&&this._movieClip.parent.removeChild(this._movieClip),this._movieClip=null,RES.destroyRes("img/startGameMc4.json"),RES.destroyRes("img/startGameMc4.png")),e.loadtimeID>0&&clearTimeout(e.loadtimeID),e.btn_return.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onBackSelectView,e),e.btn_start.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onStartGame,e),e.btn_random.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onRandomNameClick,e),e.occupationSex.removeEventListener(eui.UIEvent.CHANGE,e.radioChangeHandler,e),e.occupationZy.removeEventListener(eui.UIEvent.CHANGE,e.zyradioChangeHandler,e),e.tx_link1.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClick,e),e.tx_link3.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClick,e),e.tx_linkGro.removeEventListener(mouse.MouseEvent.ROLL_OVER,e.showTxTips,e),e.tx_linkGro.removeEventListener(mouse.MouseEvent.ROLL_OUT,e.closeTxTips,e),clearInterval(e.timeOut),RES.destroyRes("ncreateRoleNew3-sheet_json")},t}(eui.Component);__reflect(CreateRoleUICtrl.prototype,"CreateRoleUICtrl");var qufu;!function(e){var t=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.autoCreateRoleTimeId=0,e.autoCreateRoleCD=0,e.nowsex=1,e.nowcarrer=1,e._disposed=!1,e.selectindex=1,e.alert=null,e.timekey=0,e.timeId=0,e.timekey1=0,e}return __extends(r,t),r.prototype.createChildren=function(){var e=this;e.skinName="CreateRoleSkin3",js_gameVars.createRoleMsg.uid2.toString()==js_gameVars.createRoleMsg.lastLoginUid.toString()?(e.nowuid=js_gameVars.createRoleMsg.uid2,e.selectindex=2):(e.nowuid=js_gameVars.createRoleMsg.uid1,e.selectindex=1),e.img_roleg1.filters=[e.getgray()],e.img_roleg2.filters=[e.getgray()],e.setinfo(),e.radioGrp=new eui.RadioButtonGroup,e.radioGrp1=new eui.RadioButtonGroup,e.btn_carrer1.group=e.radioGrp,e.btn_carrer1.value=1,e.btn_carrer2.group=e.radioGrp,e.btn_carrer2.value=2,e.btn_carrer3.group=e.radioGrp,e.btn_carrer3.value=3,e.btn_sex1.group=e.radioGrp1,e.btn_sex1.value=1,e.btn_sex2.group=e.radioGrp1,e.btn_sex2.value=2,e.img_role1.addEventListener(egret.TouchEvent.TOUCH_TAP,e.changecarrer,e),e.img_role2.addEventListener(egret.TouchEvent.TOUCH_TAP,e.changecarrer,e),e.btn_tj.addEventListener(egret.TouchEvent.TOUCH_TAP,e.putcreaterole,e),e.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,e.startgame,e),e.btn_create.addEventListener(egret.TouchEvent.TOUCH_TAP,e.createrole,e),e.btn_random.addEventListener(egret.TouchEvent.TOUCH_TAP,e.setrandomname,e),e.txt_input.addEventListener(egret.FocusEvent.FOCUS_IN,e.onFocusIn,e),e.txt_input.addEventListener(egret.FocusEvent.FOCUS_OUT,e.onFocusOut,e),e.btn_choose1.addEventListener(egret.TouchEvent.TOUCH_TAP,e.changecarrer,e),e.btn_choose2.addEventListener(egret.TouchEvent.TOUCH_TAP,e.changecarrer,e),e.radioGrp.addEventListener(eui.UIEvent.CHANGE,e.onChangeUIType,e),e.radioGrp1.addEventListener(eui.UIEvent.CHANGE,e.onChangeUIType1,e),e.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,e.closecreate,e),e.btn_return.addEventListener(egret.TouchEvent.TOUCH_TAP,e.returnqufu,e),e.btn_huifu.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onTouch,e),e.btn_delete.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onTouch,e);for(var t=1;3>=t;t++)t==e.nowcarrer&&(e["txt_carrer"+t].textColor=16770048);for(var t=1;2>=t;t++)t==e.nowsex&&(e["txt_sex"+t].textColor=16770048);return e.txt_qufu.text=js_gameVars.serverName,RES.getResByUrl("img/startbtn_eff.json",e.startloadedJsonHandler,e,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/startbtn_eff.png",e.startloadedPngHandler,e,RES.ResourceItem.TYPE_IMAGE),e.loadtimeID=setTimeout(function(){e.startLoad()},5e3),js_gameVars.is_needFcm&&1!=js_gameVars.is_adult?void e.showAlert(!0):void("function"==typeof apiEnterCreateRoleView&&apiEnterCreateRoleView(js_gameVars.username,js_gameVars.roleid,egret.getTimer(),js_gameVars.platform,js_gameVars.serverid))},r.prototype.showAlert=function(t){void 0===t&&(t=!0);var r=this;null==r.alert&&(r.alert=new e.FcmAlert),t?(r.alert.onResize(e.SceneManager.Instance._stage.stageWidth,e.SceneManager.Instance._stage.stageHeight),r.parent.addChild(r.alert),r.touchEnabled=r.touchChildren=!1):(r.touchEnabled=r.touchChildren=!0,r.parent.removeChild(r.alert))},r.prototype.clearAutoCreateRole=function(){var e=this;e.autoCreateRoleTimeId>0&&(clearInterval(e.autoCreateRoleTimeId),e.autoCreateRoleTimeId=0),e.txt_cd.visible=!1},r.prototype.doAutoCreateRole=function(){var e=this;if(0==js_gameVars.is_adult||10==js_gameVars.platform&&2==js_gameVars.is_adult)return void(e.txt_cd.visible=!1);if(js_gameVars.isMobile||js_gameVars.noCD)e.txt_cd.visible=!1;else{if(e.autoCreateRoleTimeId>0)return;e.txt_cd.visible=!0,e.initDaoJiShi(),e.autoCreateRoleTimeId=setInterval(function(){e.autoCreateRoleTick()},1e3),e.autoCreateRoleTick()}},r.prototype.autoCreateRoleTick=function(){var e=this;e.txt_cd.visible&&(e.txt_cd.text="("+e.autoCreateRoleCD+")",e.autoCreateRoleCD--,e.autoCreateRoleCD<=0&&(e.clearAutoCreateRole(),e.putcreaterole(null)))},r.prototype.initDaoJiShi=function(){this.autoCreateRoleCD=20,js_gameVars.defaultDaoJiShi&&(this.autoCreateRoleCD=js_gameVars.defaultDaoJiShi)},r.prototype.stopAutoCreateRole=function(e){var t=this;e?(t.txt_cd.visible=!1,t.initDaoJiShi()):t.autoCreateRoleTimeId>0&&(t.txt_cd.visible=!0,t.initDaoJiShi(),t.autoCreateRoleTick())},r.prototype.startLoad=function(){var e=this;e.loader=new egret.URLLoader,e.loader.dataFormat=egret.URLLoaderDataFormat.SOUND,e.loader.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this);var t,r="audio/",n=".wav",i=".mp3",o=js_gameVars.resUrl?js_gameVars.resUrl:"http://192.168.5.66:8081/";t=js_gameVars.mobileUI||1==js_gameVars.client?o+r+1003+i:o+r+1003+n,void 0==js_gameVars.cdnServer||(t=js_gameVars.cdnServer+t+("?qufu_version="+js_gameVars.qufu_version));var s=new egret.URLRequest(t);e.loader.load(s)},r.prototype.onLoadComplete=function(e){var t=this,r=e.target;r.data&&(t.sound=r.data,t.startSound()),t.loader.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this)},r.prototype.startSound=function(){this.soundChannel=this.sound.play(0,-1)},r.prototype.stopSound=function(){var e=this;e.soundChannel&&(e.soundChannel.stop(),e.soundChannel=null),e.sound&&(e.sound.close(),e.sound=null),e.loader&&(e.loader.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),e.loader=null)},r.prototype.returnqufu=function(){if(window.top)try{window.top.location.reload()}catch(e){window.location.reload()}else window.location.reload();egret.nativeRender&&egret.ExternalInterface.call("ResExitGame",js_gameVars.username)},r.prototype.onTouch=function(e){var t=this;t.txt_err.visible=!0,egret.clearTimeout(this.timekey),t.timekey=egret.setTimeout(function(){t.txt_err.visible=!1},t,2e3)},r.prototype.closecreate=function(e){var t=this;t.clearAutoCreateRole(),t.create_grp.visible=!1;var r=js_gameVars.createRoleMsg;r.roleName1||r.roleName2?r.roleName1&&!r.roleName2&&(t.eff_grp1.visible=!1):t.eff_grp0.visible=!1,t.nowsex=1},r.prototype.onChangeUIType=function(e){var t=this;t.nowcarrer=t.radioGrp.selectedValue;for(var r=1;3>=r;r++)r==t.nowcarrer?t["txt_carrer"+r].textColor=16770048:t["txt_carrer"+r].textColor=16777215;t.checkload(),t.stopAutoCreateRole(!1)},r.prototype.onChangeUIType1=function(e){var t=this;t.nowsex=t.radioGrp1.selectedValue;for(var r=1;2>=r;r++)r==t.nowsex?t["txt_sex"+r].textColor=16770048:t["txt_sex"+r].textColor=16777215;t.checkload(),t.stopAutoCreateRole(!1)},r.prototype.setrandomname=function(t){e.QufuMessageHandler.sendReqRandomNameMessage(this.nowsex),this.stopAutoCreateRole(!1)},r.prototype.onFocusIn=function(e){this.stopAutoCreateRole(!0)},r.prototype.onFocusOut=function(e){this.stopAutoCreateRole(!1)},r.prototype.updateName=function(e){var t=this;t.txt_input.text=js_gameVars.createRoleMsg.randomRoleName,t.doAutoCreateRole()},r.prototype.changecarrer=function(e){var t=this;switch(e.target){case t.btn_choose1:case t.img_role1:if(js_gameVars.is_needFcm&&1!=js_gameVars.is_adult)return void t.showAlert(!0);if(1==t.selectindex||!js_gameVars.createRoleMsg.roleName1||!js_gameVars.createRoleMsg.roleName2)return;egret.Tween.removeAllTweens(),t.selectindex=1,js_gameVars.createRoleMsg.uid1&&(t.nowuid=js_gameVars.createRoleMsg.uid1),t.maskShape.y=223,t.maskShape1.y=-137,t.eff_grp0.visible=!1,t.eff_grp1.visible=!1,t.img_role1.visible=t.img_roleg1.visible=t.maskShape.visible=!0,t.img_role2.visible=t.img_roleg2.visible=t.maskShape1.visible=!0,egret.Tween.get(t.maskShape).to({y:-137},1500).call(function(){t.eff_grp0.visible=!0,t.img_role1.visible=t.img_roleg1.visible=t.maskShape.visible=!1},t),egret.Tween.get(t.maskShape1).to({y:223},1500).call(function(){t.img_role2.visible=t.img_roleg2.visible=t.maskShape1.visible=!0},t),t.create_grp.visible=!1,t.clearAutoCreateRole(),RES.getResByUrl("img/create_eff.json",t.createloadedJsonHandler,t,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/create_eff.png",t.createloadedPngHandler,t,RES.ResourceItem.TYPE_IMAGE);break;case t.btn_choose2:case t.img_role2:if(js_gameVars.is_needFcm&&1!=js_gameVars.is_adult)return void t.showAlert(!0);if(2==t.selectindex||!js_gameVars.createRoleMsg.roleName1||!js_gameVars.createRoleMsg.roleName2)return;egret.Tween.removeAllTweens(),t.selectindex=2,js_gameVars.createRoleMsg.uid2&&(t.nowuid=js_gameVars.createRoleMsg.uid2),t.maskShape.y=-137,t.maskShape1.y=223,t.eff_grp0.visible=!1,t.eff_grp1.visible=!1,t.img_role1.visible=t.img_roleg1.visible=t.maskShape.visible=!0,t.img_role2.visible=t.img_roleg2.visible=t.maskShape1.visible=!0,egret.Tween.get(t.maskShape).to({y:223},1500).call(function(){t.img_role1.visible=t.img_roleg1.visible=t.maskShape.visible=!0},t),egret.Tween.get(t.maskShape1).to({y:-137},1500).call(function(){t.eff_grp1.visible=!0,t.img_role2.visible=t.img_roleg2.visible=t.maskShape1.visible=!1},t),t.create_grp.visible=!1,t.clearAutoCreateRole(),RES.getResByUrl("img/create_eff.json",t.createloadedJsonHandler,t,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/create_eff.png",t.createloadedPngHandler,t,RES.ResourceItem.TYPE_IMAGE)}t.stopAutoCreateRole(!1)},r.prototype.showmodel=function(){var e=this;e.maskShape||(e.maskShape=new egret.Shape,e.maskShape.graphics.beginFill(16711680,1),e.maskShape.graphics.drawRect(0,0,300,360),e.maskShape.graphics.endFill(),e.maskShape.x=e.img_roleg1.x,e.maskShape.y=e.img_roleg1.y,e.img_roleg1.mask=e.maskShape,e.addChild(e.maskShape))},r.prototype.showmodel1=function(){var e=this;e.maskShape1||(e.maskShape1=new egret.Shape,e.maskShape1.graphics.beginFill(16711680,1),e.maskShape1.graphics.drawRect(0,0,300,360),e.maskShape1.graphics.endFill(),e.maskShape1.x=e.img_roleg2.x,e.maskShape1.y=e.img_roleg2.y,e.img_roleg2.mask=e.maskShape1,e.addChild(e.maskShape1))},r.prototype.getgray=function(){return new egret.ColorMatrixFilter([.1,.6,0,0,0,.1,.6,0,0,0,.1,.6,0,0,0,0,0,0,1,0])},r.prototype.checkload=function(){var e=this,t=js_gameVars.createRoleMsg;t.roleName1||t.roleName2?t.roleName1&&!t.roleName2?e.loadres1():t.roleName1&&t.roleName2&&e.loadres2():e.loadres()},r.prototype.loadres=function(){var e=this;RES.getResByUrl("img/carrer"+e.nowcarrer+"_"+e.nowsex+".json",e.loadedJsonHandler,e,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/carrer"+e.nowcarrer+"_"+e.nowsex+".png",e.loadedPngHandler,e,RES.ResourceItem.TYPE_IMAGE)},r.prototype.loadres0=function(){var e=this,t=js_gameVars.createRoleMsg;RES.getResByUrl("img/carrer"+t.career1+"_"+t.sex1+".json",e.loadedJsonHandler,e,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/carrer"+t.career1+"_"+t.sex1+".png",e.loadedPngHandler,e,RES.ResourceItem.TYPE_IMAGE)},r.prototype.loadres1=function(){var e=this,t=js_gameVars.createRoleMsg;RES.getResByUrl("img/carrer"+t.career1+"_"+t.sex1+".json",e.loadedJsonHandler,e,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/carrer"+t.career1+"_"+t.sex1+".png",e.loadedPngHandler,e,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl("img/carrer"+e.nowcarrer+"_"+e.nowsex+".json",e.loadedJsonHandler1,e,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/carrer"+e.nowcarrer+"_"+e.nowsex+".png",e.loadedPngHandler1,e,RES.ResourceItem.TYPE_IMAGE)},r.prototype.loadres2=function(){var e=this,t=js_gameVars.createRoleMsg;RES.getResByUrl("img/carrer"+t.career1+"_"+t.sex1+".json",e.loadedJsonHandler,e,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/carrer"+t.career1+"_"+t.sex1+".png",e.loadedPngHandler,e,RES.ResourceItem.TYPE_IMAGE),RES.getResByUrl("img/carrer"+t.career2+"_"+t.sex2+".json",e.loadedJsonHandler1,e,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/carrer"+t.career2+"_"+t.sex2+".png",e.loadedPngHandler1,e,RES.ResourceItem.TYPE_IMAGE)},r.prototype.loadedJsonHandler=function(e,t){var r=this;r._movieData=e,r.movieCreate()},r.prototype.loadedPngHandler=function(e,t){var r=this;r._movieImage=e,r.movieCreate()},r.prototype.movieCreate=function(){var e=this;if(e._movieData&&e._movieImage){if(e._disposed)return;e._movieClip1&&(e._movieClip1.parent.removeChild(e._movieClip1),e._movieClip1=null);var t=new egret.MovieClipDataFactory(e._movieData,e._movieImage);t.enableCache=!1;var r=js_gameVars.createRoleMsg,n=e.nowcarrer,i=e.nowsex;r.roleName1||r.roleName2?(n=r.career1,i=r.sex1,e._movieClip1=new egret.MovieClip(t.generateMovieClipData("carrer"+r.career1+"_"+r.sex1))):e._movieClip1=new egret.MovieClip(t.generateMovieClipData("carrer"+e.nowcarrer+"_"+e.nowsex)),e.eff_grp0.addChild(e._movieClip1),e._movieClip1.x=30,e._movieClip1.y=-60,1==n&&2==i&&(e._movieClip1.x=31),2==n&&2==i&&(e._movieClip1.x=42,e._movieClip1.y=-68),3==n&&2==i&&(e._movieClip1.x=41,e._movieClip1.y=-52),e._movieClip1.touchEnabled=!1,e._movieClip1.play(-1)}},r.prototype.loadedJsonHandler1=function(e,t){var r=this;r._movieData1=e,r.movieCreate1()},r.prototype.loadedPngHandler1=function(e,t){var r=this;r._movieImage1=e,r.movieCreate1()},r.prototype.movieCreate1=function(){var e=this;if(e._movieData1&&e._movieImage1){if(e._disposed)return;e._movieClip2&&(e._movieClip2.parent.removeChild(e._movieClip2),e._movieClip2=null);var t=new egret.MovieClipDataFactory(e._movieData1,e._movieImage1);t.enableCache=!1;var r=js_gameVars.createRoleMsg,n=e.nowcarrer,i=e.nowsex;r.roleName1&&!r.roleName2?e._movieClip2=new egret.MovieClip(t.generateMovieClipData("carrer"+e.nowcarrer+"_"+e.nowsex)):(n=r.career2,i=r.sex2,e._movieClip2=new egret.MovieClip(t.generateMovieClipData("carrer"+r.career2+"_"+r.sex2))),e.eff_grp1.addChild(e._movieClip2),e._movieClip2.x=30,e._movieClip2.y=-60,1==n&&2==i&&(e._movieClip2.x=31),2==n&&2==i&&(e._movieClip2.x=42,e._movieClip2.y=-68),3==n&&2==i&&(e._movieClip2.x=41,e._movieClip2.y=-52),e._movieClip2.touchEnabled=!1,e._movieClip2.play(-1)}},r.prototype.createloadedJsonHandler=function(e,t){var r=this;r._createData=e,r.createmovieCreate()},r.prototype.createloadedPngHandler=function(e,t){var r=this;r._createImage=e,r.createmovieCreate()},r.prototype.createmovieCreate=function(){var e=this;if(e._createData&&e._createImage){if(e._disposed)return;e._createClip&&(e._createClip.parent.removeChild(e._createClip),e._createClip=null);var t=new egret.MovieClipDataFactory(e._createData,e._createImage);t.enableCache=!1;js_gameVars.createRoleMsg;e._createClip=new egret.MovieClip(t.generateMovieClipData("create_eff")),e.addChild(e._createClip),1==e.selectindex?(e._createClip.x=415,e._createClip.y=233):(e._createClip.x=778,e._createClip.y=233),e._createClip.touchEnabled=!1,e._createClip.blendMode=egret.BlendMode.ADD,e._createClip.play(1),e._createClip.once(egret.Event.COMPLETE,function(t){e._createClip.visible=!1},e)}},r.prototype.startloadedJsonHandler=function(e,t){var r=this;r._startData=e,r.startmovieCreate()},r.prototype.startloadedPngHandler=function(e,t){var r=this;r._startImage=e,r.startmovieCreate()},r.prototype.startmovieCreate=function(){var e=this;if(e._startData&&e._startImage){if(e._disposed)return;e._startClip&&(e._startClip.parent.removeChild(e._startClip),e._startClip=null);var t=new egret.MovieClipDataFactory(e._startData,e._startImage);t.enableCache=!1;js_gameVars.createRoleMsg;e._startClip=new egret.MovieClip(t.generateMovieClipData("startbtn_eff")),e.grp1.addChild(e._startClip),e._startClip.x=658,e._startClip.y=630,e._startClip.touchEnabled=!1,e._startClip.blendMode=egret.BlendMode.ADD,e._startClip.play(-1)}},r.prototype.createrole=function(t){var r=this,n=js_gameVars.createRoleMsg;if(n.roleName1&&n.roleName2)return void console.log("角色已满");r.doAutoCreateRole(),r.create_grp.visible=!0,n.roleName1?(this.eff_grp1.visible=!0,r.create_grp.x=376):(this.eff_grp0.visible=!0,r.create_grp.x=735),e.QufuMessageHandler.sendReqRandomNameMessage(this.nowsex),r.randomcarrer();for(var i=1;3>=i;i++)i==r.nowcarrer?r["txt_carrer"+i].textColor=16770048:r["txt_carrer"+i].textColor=16777215;r.btn_sex1.selected=!0,r.btn_sex2.selected=!1,r.checkload()},r.prototype.startgame=function(t){var r=this;return js_gameVars.is_needFcm&&1!=js_gameVars.is_adult?void r.showAlert(!0):(r.create_grp.visible?js_gameVars.createRoleMsg.randomRoleName&&e.QufuMessageHandler.sendReqCreateRoleMessage(r.txt_input.text,r.nowsex,r.nowcarrer):(r.pushTryEnterGame(),e.QufuMessageHandler.sendReqTryEnterGameMessage(this.nowuid)),r.btn_start.enabled=!1,void(r.timeId=egret.setTimeout(function(){r.timeId=0,r.btn_start.enabled=!0
},r,300)))},r.prototype.pushTryEnterGame=function(){var e=0,t="",r="";if(js_gameVars.createRoleMsg&&this.nowuid)for(var n=1;2>=n;n++){var i=js_gameVars.createRoleMsg["uid"+n];if(this.nowuid.equals(i)){e=js_gameVars.createRoleMsg["level"+n],t=js_gameVars.createRoleMsg["roleName"+n],r=1==js_gameVars.createRoleMsg["sex"+n]?"男":"女";break}}var o={uid:js_gameVars.username,roleId:this.nowuid?this.nowuid.toLongString():"",roleName:t,sex:r,level:e,platform:js_gameVars.platform,sid:js_gameVars.serverid,serverName:js_gameVars.serverName,qudao:js_gameVars.qudao,time:(new Date).getTime()};"function"==typeof apiBeforeEnterGame&&apiBeforeEnterGame(o)},r.prototype.putcreaterole=function(t){var r=this;return js_gameVars.is_needFcm&&1!=js_gameVars.is_adult?void r.showAlert(!0):void e.QufuMessageHandler.sendReqCreateRoleMessage(r.txt_input.text,r.nowsex,r.nowcarrer)},r.prototype.errtips=function(e){var t=this;t.text_err.text=e,t.text_err.visible=!0,egret.clearTimeout(t.timekey1),t.timekey1=egret.setTimeout(function(){t.text_err.visible=!1},t,2e3)},r.prototype.setinfo=function(){var e=this,t=js_gameVars.createRoleMsg;t&&(t.roleName1||t.roleName2?t.roleName1&&!t.roleName2?(e.loadres0(),e.txt_name0.visible=e.txt_c0.visible=e.txt_level0.visible=!0,e.txt_level1.visible=e.txt_name1.visible=e.txt_c1.visible=!1,e.create_grp.visible=!1,e.clearAutoCreateRole(),e.txt_level0.text=t.level1+"",e.txt_name0.text=t.roleName1,e.txt_c0.text=e.getcarrer(t.career1),e.nowuid=t.uid1,e.img_role1.visible=e.img_roleg1.visible=!1,e.img_role2.visible=e.img_roleg2.visible=!1):t.roleName1&&t.roleName2&&(e.loadres2(),e.txt_name0.visible=e.txt_name1.visible=e.txt_level0.visible=e.txt_level1.visible=e.txt_c0.visible=e.txt_c1.visible=!0,e.create_grp.visible=!1,e.clearAutoCreateRole(),e.txt_level0.text=t.level1+"",e.txt_name0.text=t.roleName1,e.txt_c0.text=e.getcarrer(t.career1),e.txt_level1.text=t.level2+"",e.txt_name1.text=t.roleName2,e.txt_c1.text=e.getcarrer(t.career2),e.img_role1.source="img_carrer"+t.career1+"_"+t.sex1,e.img_roleg1.source="img_carrer"+t.career1+"_"+t.sex1,e.img_role2.source="img_carrer"+t.career2+"_"+t.sex2,e.img_roleg2.source="img_carrer"+t.career2+"_"+t.sex2,e.showmodel(),e.showmodel1(),e.img_role1.visible=e.img_roleg1.visible=e.maskShape.visible=2==e.selectindex,e.img_role2.visible=e.img_roleg2.visible=e.maskShape1.visible=1==e.selectindex,e.eff_grp1.visible=2==e.selectindex,e.eff_grp0.visible=1==e.selectindex):(e.txt_name0.visible=e.txt_name1.visible=e.txt_level0.visible=e.txt_level1.visible=e.txt_c0.visible=e.txt_c1.visible=!1,e.create_grp.visible=!0,e.doAutoCreateRole(),e.txt_input.text=t.randomRoleName,e.randomcarrer(),e.loadres(),e.btn_sex1.selected=!0,e.btn_sex2.selected=!1,e.img_role1.visible=e.img_roleg1.visible=!1,e.img_role2.visible=e.img_roleg2.visible=!1))},r.prototype.randomcarrer=function(){for(var e=this,t=Math.floor(3*Math.random()+1),r=1;3>=r;r++)t==r&&(e["btn_carrer"+t].selected=!0);e.nowcarrer=t},r.prototype.getcarrer=function(e){var t="";switch(e){case 1:t="战士";break;case 2:t="法师";break;case 3:t="道士"}return t},r.prototype.closed=function(){},r.prototype.onResize=function(e,t){var r=this;r.x=e-r.skin.width>>1,r.y=t-r.skin.height>>1,1==js_gameVars.isMobile&&(egret.nativeRender?(r.grp1.scaleX=.8,r.grp1.scaleY=.8):(r.grp1.scaleX=.85,r.grp1.scaleY=.85)),r.alert&&r.alert.onResize(e,t)},r.prototype.dispose=function(){var e=this;e.btn_return.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.returnqufu,e),e.btn_huifu.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onTouch,e),e.btn_delete.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onTouch,e),e.img_role1.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.changecarrer,e),e.img_role2.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.changecarrer,e),e.btn_tj.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.putcreaterole,e),e.btn_start.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.startgame,e),e.btn_create.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.createrole,e),e.btn_random.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.setrandomname,e),e.txt_input.removeEventListener(egret.FocusEvent.FOCUS_IN,e.onFocusIn,e),e.txt_input.removeEventListener(egret.FocusEvent.FOCUS_OUT,e.onFocusOut,e),e.btn_choose1.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.changecarrer,e),e.btn_choose2.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.changecarrer,e),e.radioGrp.removeEventListener(eui.UIEvent.CHANGE,e.onChangeUIType,e),e.radioGrp1.removeEventListener(eui.UIEvent.CHANGE,e.onChangeUIType1,e),e.btn_close.removeEventListener(eui.UIEvent.CHANGE,e.closecreate,e),e._disposed=!0,this._movieClip1&&(this._movieClip1.parent&&this._movieClip1.parent.removeChild(this._movieClip1),this._movieClip1=null,RES.destroyRes("img/carrer1_1.json"),RES.destroyRes("img/carrer1_1.png"),RES.destroyRes("img/carrer1_2.json"),RES.destroyRes("img/carrer1_2.png"),RES.destroyRes("img/carrer2_1.json"),RES.destroyRes("img/carrer2_1.png"),RES.destroyRes("img/carrer2_2.json"),RES.destroyRes("img/carrer2_2.png"),RES.destroyRes("img/carrer3_1.json"),RES.destroyRes("img/carrer3_1.png"),RES.destroyRes("img/carrer3_2.json"),RES.destroyRes("img/carrer3_2.png")),this.stopSound(),e.loadtimeID>0&&clearTimeout(e.loadtimeID),this._movieClip2&&(this._movieClip2.parent&&this._movieClip2.parent.removeChild(this._movieClip2),this._movieClip2=null),this._createClip&&(this._createClip.parent&&this._createClip.parent.removeChild(this._createClip),this._createClip=null,RES.destroyRes("img/create_eff.json"),RES.destroyRes("img/create_eff.png")),this._startClip&&(this._startClip.parent&&this._startClip.parent.removeChild(this._startClip),this._startClip=null,RES.destroyRes("img/startbtn_eff.json"),RES.destroyRes("img/startbtn_eff.png")),this.parent&&this.parent.removeChild(this),RES.destroyRes("y_createrole-sheet_json"),e.timeId>0&&(egret.clearTimeout(e.timeId),e.timeId=0),e.clearAutoCreateRole(),e.alert&&(e.alert.parent&&e.alert.parent.removeChild(e.alert),e.alert=null)},r}(eui.Component);e.CreateRoleUICtrl3=t,__reflect(t.prototype,"qufu.CreateRoleUICtrl3")}(qufu||(qufu={}));var CreateRoleUICtrlTanWan=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._disposed=!1,t}return __extends(t,e),t.prototype.createChildren=function(){var e=this;this.skinName="CreateRoleSkinTanWan",e.occupationSex=new eui.RadioButtonGroup,e.r_sex1.group=e.occupationSex,e.r_sex2.group=e.occupationSex,e.r_sex1.value=1,e.r_sex2.value=2,e.occupationZy=new eui.RadioButtonGroup,e.r_zy1.group=e.occupationZy,e.r_zy2.group=e.occupationZy,e.r_zy3.group=e.occupationZy,e.r_zy1.value=1,e.r_zy2.value=2,e.r_zy3.value=3;var t=Math.floor(2*Math.random()+1),r=Math.floor(3*Math.random()+1);1==t?e.r_sex1.selected=!0:e.r_sex2.selected=!0,1==r?(e.r_zy1.selected=!0,e.img_sel.x=e.r_zy1.x-7,e.img_sel.y=e.r_zy1.y-3):2==r?(e.r_zy2.selected=!0,e.img_sel.x=e.r_zy2.x-7,e.img_sel.y=e.r_zy2.y-3):(e.r_zy3.selected=!0,e.img_sel.x=e.r_zy3.x-7,e.img_sel.y=e.r_zy3.y-3),e.roleNameTxt.text=js_gameVars.createRoleMsg.randomRoleName,e.invite=0,e.invite=js_gameVars.createRoleMsg.needActiveCode,0==e.invite?e.grp_jhm.visible=!1:e.grp_jhm.visible=!0,e.text_err.visible=!1,e.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onStartGame,e),e.occupationSex.addEventListener(eui.UIEvent.CHANGE,e.radioChangeHandler,e),e.occupationZy.addEventListener(eui.UIEvent.CHANGE,e.zyradioChangeHandler,e),e.btn_random.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onRandomNameClick,e),e.time=30,e.setTimeLimit(),e.img_nan.scaleX=.65,e.img_nan.scaleY=.65,e.img_nan.source="qufu_resource1/assets/gameui2/jpg/createRole3/ncrer_zy"+r+t+".png",RES.getResByUrl("img/startGameMc6.json",this.loadedJsonHandler,this,RES.ResourceItem.TYPE_JSON),RES.getResByUrl("img/startGameMc6.png",this.loadedPngHandler,this,RES.ResourceItem.TYPE_IMAGE),"function"==typeof apiEnterCreateRoleView&&apiEnterCreateRoleView(js_gameVars.username,js_gameVars.roleid,egret.getTimer(),js_gameVars.platform,js_gameVars.serverid),e.loadtimeID=setTimeout(function(){e.startLoad()},9500)},t.prototype.updateName=function(e){this.roleNameTxt.text=e},t.prototype.invitetips=function(e){this.txt_invite.text=e,this.img_txtbg.width=this.txt_invite.width+20},t.prototype.errtips=function(e){this.text_err.visible=!0,this.text_err.text=e},t.prototype.loadedJsonHandler=function(e,t){this._movieData=e,this.movieCreate()},t.prototype.loadedPngHandler=function(e,t){this._movieImage=e,this.movieCreate()},t.prototype.movieCreate=function(){var e=this;if(this._movieData&&this._movieImage){if(this._disposed)return;var t=new egret.MovieClipDataFactory(this._movieData,this._movieImage);t.enableCache=!1,e._movieClip=new egret.MovieClip(t.generateMovieClipData("startGameMc6")),e.grp_eff.addChild(this._movieClip),1==parseInt(js_gameVars.isMobile)?(e._movieClip.scaleX=.8,e._movieClip.scaleY=.8,e._movieClip.x=-38,e._movieClip.y=38):(e._movieClip.x=-47,e._movieClip.y=27),e._movieClip.touchEnabled=!1,e._movieClip.play(-1)}},t.prototype.setTimeLimit=function(){var e=this;e.timeOut&&clearInterval(e.timeOut),e.txt_limitTime.textFlow=e.textFlowStr(),e.time--,e.timeOut=setInterval(function(){e.txt_limitTime.textFlow=e.textFlowStr(),e.time--,e.time<0&&(clearInterval(e.timeOut),e.onStartGame())},1e3)},t.prototype.textFlowStr=function(){var e="<font color=0xce2110>"+this.time+"s</font><font color=0xce2110 >后进入游戏！</font>",t=new egret.HtmlTextParser,r=t.parser(e);return r},t.prototype.radioChangeHandler=function(e){var t=this,r=e.target;r==t.occupationSex,t.img_nan.source="qufu_resource1/assets/gameui2/jpg/createRole3/ncrer_zy"+t.occupationZy.selectedValue+t.occupationSex.selectedValue+".png",t.time=30,t.setTimeLimit()},t.prototype.zyradioChangeHandler=function(e){var t=this,r=e.target,n=t["r_zy"+r.selectedValue];t.img_sel.x=n.x-7,t.img_sel.y=n.y-3,t.img_nan.source="qufu_resource1/assets/gameui2/jpg/createRole3/ncrer_zy"+t.occupationZy.selectedValue+t.occupationSex.selectedValue+".png",t.time=30,t.setTimeLimit()},t.prototype.onRandomNameClick=function(e){var t=this;qufu.QufuMessageHandler.sendReqRandomNameMessage(t.occupationSex.selectedValue),t.time=30,t.setTimeLimit()},t.prototype.onStartGame=function(){var e=this,t=e.roleNameTxt.text;return t.indexOf("#")>=0?void 0:("function"==typeof apiCreateRoleBtnClick&&apiCreateRoleBtnClick(js_gameVars.username,0,egret.getTimer(),js_gameVars.platform,t,e.occupationSex.selectedValue,e.occupationZy.selectedValue,js_gameVars.serverid),js_gameVars.createRoleName=t,qufu.QufuMessageHandler.sendReqTemporaryRoleMessage(t,e.occupationSex.selectedValue,e.occupationZy.selectedValue,e.txt_jhm.text),!0)},t.prototype.startLoad=function(){var e=this;e.loader=new egret.URLLoader,e.loader.dataFormat=egret.URLLoaderDataFormat.SOUND,e.loader.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this);var t,r="audio/",n=".wav",i=".mp3",o=js_gameVars.resUrl?js_gameVars.resUrl:"http://192.168.5.66:8081/";t=js_gameVars.mobileUI||1==js_gameVars.client?o+r+10301+i:o+r+10301+n,void 0==js_gameVars.cdnServer||(t=js_gameVars.cdnServer+t+("?qufu_version="+js_gameVars.qufu_version));var s=new egret.URLRequest(t);e.loader.load(s)},t.prototype.onLoadComplete=function(e){var t=this,r=e.target;r.data&&(t.sound=r.data,t.startSound()),t.loader.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this)},t.prototype.startSound=function(){this.soundChannel=this.sound.play(0,-1)},t.prototype.stopSound=function(){var e=this;e.soundChannel&&(e.soundChannel.stop(),e.soundChannel=null),e.sound&&(e.sound.close(),e.sound=null),e.loader&&(e.loader.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),e.loader=null)},t.prototype.onResize=function(e,t){var r=this;r.x=e-r.skin.width>>1,r.y=t-r.skin.height>>1,1==parseInt(js_gameVars.isMobile)?(r.img_bg.source="qufu_resource1/assets/gameui2/jpg/createRole3/tanwan_bg_m.jpg",r.img_nan.scaleX=.5,r.img_nan.scaleY=.5,r.img_nan.y=585,r.grp_btns.scaleX=r.grp_name.scaleX=r.btn_start.scaleX=.8,r.grp_btns.scaleY=r.grp_name.scaleY=r.btn_start.scaleY=.8,r.grp_btns.horizontalCenter=330,r.grp_btns.verticalCenter=-30,r.grp_eff.x=130,r.grp_name.y=380,r.grp_name.x=100,r.grp_jhm.y=(t+r.skin.height)/2-183):(r.img_bg.source="qufu_resource1/assets/gameui2/jpg/createRole3/tanwan_bg.jpg",r.grp_btns.horizontalCenter=430,r.grp_btns.verticalCenter=-50,r.zyGro.x=-740,r.mainGro.x=-755,r.zyGro.y=82,r.mainGro.y=540,r.grp_jhm.y=(t+r.skin.height)/2-160-93)},t.prototype.dispose=function(){this.stopSound(),this.parent&&this.parent.removeChild(this);var e=this;e._disposed=!0,this._movieClip&&(this._movieClip.parent&&this._movieClip.parent.removeChild(this._movieClip),this._movieClip=null,RES.destroyRes("img/startGameMc.json"),RES.destroyRes("img/startGameMc.png")),e.loadtimeID>0&&clearTimeout(e.loadtimeID),e.btn_start.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onStartGame,e),e.btn_random.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onRandomNameClick,e),e.occupationSex.removeEventListener(eui.UIEvent.CHANGE,e.radioChangeHandler,e),e.occupationZy.removeEventListener(eui.UIEvent.CHANGE,e.zyradioChangeHandler,e),clearInterval(e.timeOut),RES.destroyRes("ncreateRoleNew3-sheet_json")},t}(eui.Component);__reflect(CreateRoleUICtrlTanWan.prototype,"CreateRoleUICtrlTanWan");var qufu;!function(e){var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.createChildren=function(){var t=this;t.skinName="FcmAlertSkin";var r="        根据国家相关规定，我们无法对未实名注册和登录的用户或未成年人用户提供游戏服务。\n        为了您更好的体验游戏，请进行防沉迷认证。";t.btn_go.visible=1==js_gameVars.showFcmBtn,t.txt_decs.textFlow=t.toEle(r),t.btn_go.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClick,t),t.onResize(e.SceneManager.Instance._stage.stageWidth,e.SceneManager.Instance._stage.stageHeight)},r.prototype.onClick=function(e){if("function"==typeof apiOpenWindowsUrl){var t={platform:js_gameVars.platform,ext1:3};apiOpenWindowsUrl(t)}},r.prototype.toEle=function(e){if(void 0==e)return[];var t=/<br>/gi,r="\n",n=e.replace(t,r),i=new egret.HtmlTextParser,o=i.parser(n);return o},r.prototype.onResize=function(e,t){var r=this;r.x=e-r.width>>1,r.y=t-r.height>>1},r.prototype.dispose=function(){var e=this;e.btn_go.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClick,e)},r}(eui.Component);e.FcmAlert=t,__reflect(t.prototype,"qufu.FcmAlert")}(qufu||(qufu={}));var qufu;!function(e){var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.createChildren=function(){var t=this;t.skinName="FixGameViewSkin",t.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onFixGame,t),t.btn_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClose,t),t.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClose,t),egret.ExternalInterface.addCallback("ResFixGame",function(){e.SceneManager.Instance._stage.touchChildren=!0})},r.prototype.onFixGame=function(){egret.nativeRender?(egret.ExternalInterface.call("ReqFixGame",""+(new Date).getTime()),e.SceneManager.Instance._stage.touchChildren=!1):alert("非原生")},r.prototype.onClose=function(){this.dispatchEvent(new egret.Event("close fixGameView"))},r.prototype.dispose=function(){var e=this;e.parent&&e.parent.removeChild(e),e.btn_sure&&e.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onFixGame,e),e.btn_cancel&&e.btn_cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClose,e),e.btn_close&&e.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClose,e)},r.prototype.onResize=function(e,t){var r=this;r.x=(e-350)/2,r.y=(t-300)/2},r}(eui.Component);e.FixGameView=t,__reflect(t.prototype,"qufu.FixGameView")}(qufu||(qufu={}));var qufu;!function(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.createChildren=function(){var t=this;t.skinName="NoticeViewSkin",t.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClose,t),t.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClose,t),t.list.itemRenderer=r,t.list.dataProvider=new eui.ArrayCollection(e.notice),t.list.addEventListener(egret.Event.CHANGE,t.onChangePage,t),t.changePage(0)},n.prototype.onChangePage=function(e){var t=this;t.changePage(t.list.selectedIndex)},n.prototype.changePage=function(t){var r=this;if(r.scroll.viewport.scrollV=0,e.notice&&e.notice.length>t){var n=e.notice[t],i=new egret.HtmlTextParser;r.txt_content.textFlow=i.parse(n.desc),r.txt_title.text=n.title}else r.txt_content.text="",r.txt_title.text="公告"},n.prototype.onClose=function(e){this.dispatchEvent(new egret.Event("close noticeview"))},n.prototype.onResize=function(e,t){this.x=(e-679)/2,this.y=(t-364)/2},n.prototype.dispose=function(){var e=this;e.list&&e.list.removeEventListener(egret.Event.CHANGE,e.onChangePage,e),e.parent&&e.parent.removeChild(e),e.btn_close&&e.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClose,e),e.btn_sure&&e.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClose,e)},n}(eui.Component);e.NoticeView=t,__reflect(t.prototype,"qufu.NoticeView");var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){this.skinName="NoticeViewRenderSkin"},t.prototype.dataChanged=function(){this.data&&(this.btn_title.label=this.data.name)},t}(eui.ItemRenderer);__reflect(r.prototype,"NoticeViewRender")}(qufu||(qufu={}));var qufu;!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e._cacheData=[],e}return __extends(i,t),i.prototype.createChildren=function(){this.skinName="SelectViewSkin",this.dataPrivder1=new eui.ArrayCollection,this.dataPrivder2=new eui.ArrayCollection,this.dataPrivder3=new eui.ArrayCollection,this.list1.itemRenderer=n,this.list2.itemRenderer=r,this.list3.itemRenderer=r,this.list1.dataProvider=this.dataPrivder1,this.bit_rect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRectClose,this);var t="苍穹灭";if(js_gameVars.qufuname&&(t=js_gameVars.qufuname),this.dataPrivder1.source.reverse(),e.serverGroup)for(var i=0;i<e.serverGroup.length;i++){var o=e.serverGroup[i];if("1"!=o.hide){o.base,o.tag;this.dataPrivder1.addItem({name:""+o.name,index:o.tag})}}for(var i=1;i<=e.numberAbc;i++)this.dataPrivder1.addItem({name:""+t+(e.pagenum*(i-1)+1)+"-"+e.pagenum*i+"区",index:i});e.isInWhiteList&&this.dataPrivder1.addItem({name:"隐藏服",index:-9999}),this.list2.dataProvider=this.dataPrivder2,this.list3.dataProvider=this.dataPrivder3,this.list1.addEventListener(egret.Event.CHANGE,this.onSelectServerlist,this),this.list1.selectedIndex=0,null!=e.lastLoginList?this.setList1(e.lastLoginList):js_gameVars.platform_debug?HttpRequest.request(js_gameVars.APIlocation+"kingapi/query_loginname.php?platform="+js_gameVars.platform_debug+"&type=query&loginname="+js_gameVars.username+"&time="+egret.getTimer(),this.onLatelyList,this):HttpRequest.request(js_gameVars.APIlocation+"kingapi/query_loginname.php?platform="+js_gameVars.qudao+"&type=query&loginname="+js_gameVars.username+"&time="+egret.getTimer(),this.onLatelyList,this),this.onSelectServerlist(null)},i.prototype.onRectClose=function(e){this.dispatchEvent(new egret.Event("close selectview"))},i.prototype.onSelectServerlist=function(t){for(var r=0;r<this.list1.numChildren;r++){var n=this.list1.getElementAt(r);n&&n.data&&n.doSelected(r==this.list1.selectedIndex)}if(-9999==this.list1.selectedItem.index)this.setList(e.servers);else{var i=this.list1.selectedItem.index;this._cacheData[i]&&this._cacheData[i].list&&this._cacheData[i].time>egret.getTimer()?this.setList(this._cacheData[i].list):js_gameVars.platform_debug?HttpRequest.request(js_gameVars.APIlocation+"server/"+js_gameVars.platform_debug+"/list_"+js_gameVars.platform_debug+"_"+i+".txt?v="+(new Date).getTime(),this.onGetData,this,null,[i]):HttpRequest.request(js_gameVars.APIlocation+"server/"+js_gameVars.platform+"/list_"+js_gameVars.platform+"_"+i+".txt?v="+(new Date).getTime(),this.onGetData,this,null,[i])}},i.prototype.onGetData=function(t,r){if(t){for(var n=JSON.parse(t),i=[],o=0;o<n.length;o++){var s=new e.NServerData;if(s.qufu_name=n[o][0],s.qufu_id=n[o][1],s.show_state=n[o][2],s.gamePort=n[o][3],s.sNum=n[o][4],s.cdn_version=n[o][5],s.qufu_name1=n[o][6],null!=e.lastLoginList)for(var a=0,l=e.lastLoginList;a<l.length;a++){var c=l[a];if(c[1]==n[o][1]){c.Recently_login=!0;break}}i[o]=s}var u=r[0];this._cacheData[u]={list:i,time:egret.getTimer()+3e4},i.reverse(),this.setList(i)}},i.prototype.setList=function(e){this.dataPrivder2.removeAll();for(var t=0,r=e;t<r.length;t++){var n=r[t];this.dataPrivder2.addItem(n)}this.dataPrivder2.refresh()},i.prototype.setList1=function(e){this.dataPrivder3.removeAll();for(var t=0,r=e;t<r.length;t++){var n=r[t];n.Recently_login=!0,this.dataPrivder3.addItem(n)}this.dataPrivder3.refresh()},i.prototype.onLatelyList=function(t){if(t){var r=JSON.parse(t);this.dataPrivder3.removeAll();for(var n=0;n<r.length;n++){var i=new e.NServerData;i.qufu_name=r[n][0],i.qufu_id=r[n][1],i.show_state=r[n][2],i.gamePort=r[n][3],i.sNum=r[n][4],i.cdn_version=r[n][5],i.qufu_name1=r[n][6],i.Recently_login=!0,this.dataPrivder3.addItem(i)}}},i.prototype.onResize=function(e,t){this.width=e,this.height=t},i.prototype.dispose=function(){this.parent&&this.parent.removeChild(this),this.bit_rect&&this.bit_rect.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onRectClose,this),this.list1&&this.list1.removeEventListener(egret.Event.CHANGE,this.onSelectServerlist,this)},i}(eui.Component);e.SelectView=t,__reflect(t.prototype,"qufu.SelectView");var r=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.createChildren=function(){this.skinName="ServerListRenderSkin",this.btn_self.once(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},r.prototype.onClick=function(t){e.EnterGameInstance.Instance.enterGame(this.data)},r.prototype.dataChanged=function(){if(this.data){1==js_gameVars.qufuType?this.btn_self.label=this.data.qufu_id+"区":2==js_gameVars.qufuType?this.btn_self.label=this.data.qufu_name+"-"+this.data.qufu_name1+"区":this.btn_self.label=this.data.qufu_name,this.img_login.visible=!1,this.data.Recently_login&&(this.img_login.visible=!0);var e="";switch(this.img_icon.y=10,this.data.show_state){case 1:e="qufu_state2_png",this.img_icon.y=15;break;case 2:e="qufu_state2_png";break;case 3:e="qufu_state3_png";break;case 4:e="qufu_state4_png"}this.img_icon.source=e}},r}(eui.ItemRenderer);__reflect(r.prototype,"ServerListRender");var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){this.skinName="ServerTabRenderSkin"},t.prototype.dataChanged=function(){this.data&&(this.txt_name.text=this.data.name,this.txt_name.strokeColor=1839368,this.doSelected(this.selected))},t.prototype.doSelected=function(e){e?this.bit_select.source="qufu_xq_btn_1_png":this.bit_select.source="qufu_xq_btn_png"},t}(eui.ItemRenderer);__reflect(n.prototype,"ServerTabRender")}(qufu||(qufu={}));var qufu;!function(e){var t=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return __extends(r,t),r.prototype.createChildren=function(){var t=this;t.skinName="ShiLingTipsSkin",t.btn_sure.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClick,t),t.onResize(e.SceneManager.Instance._stage.stageWidth,e.SceneManager.Instance._stage.stageHeight)},r.prototype.onClick=function(e){this.dispatchEvent(new egret.Event("close shilingTips"))},r.prototype.onResize=function(e,t){var r=this;r.x=e-r.width>>1,r.y=t-r.height>>1},r.prototype.dispose=function(){var e=this;e.btn_sure&&e.btn_sure.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClick,e)},r}(eui.Component);e.ShiLingTips=t,__reflect(t.prototype,"qufu.ShiLingTips")}(qufu||(qufu={}));var qufu;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){var e=this;e.skinName="XieYiSkin",e.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onClose,e),js_gameVars.xieyiTxt&&(e.lbl_content.text=js_gameVars.xieyiTxt)},t.prototype.onClose=function(e){this.dispatchEvent(new egret.Event("close xieyi"))},t.prototype.onResize=function(e,t){var r=this;r.x=(e-450)/2,r.y=(t-400)/2},t.prototype.dispose=function(){var e=this;e.parent&&e.parent.removeChild(e),e.btn_close&&e.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.onClose,e)},t}(eui.Component);e.XieYiView=t,__reflect(t.prototype,"qufu.XieYiView")}(qufu||(qufu={})),window.qufu=qufu,window.Long=Long,window.Input=Input,window.Output=Output,window.HttpRequest=HttpRequest;